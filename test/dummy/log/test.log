--------------------------------------------------------------------------------
GithubSignIn::ButtonHelperTest: test_generating_a_login_button_with_text_content
--------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
GithubSignIn::ButtonHelperTest: test_generating_a_login_button_with_custom_attributes
-------------------------------------------------------------------------------------
--------------------------------------------------------------------------------
GithubSignIn::ButtonHelperTest: test_generating_a_login_button_with_HTML_content
--------------------------------------------------------------------------------
----------------------------------------------------------------------------------------
GithubSignIn::AuthorizationsControllerTest: test_redirecting_to_Github_for_authorization
----------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=p3%2FvvCOK4scYu3YIGCTHlIu4pbA%2BfnHO
Completed 302 Found in 2ms (Allocations: 1066)
-----------------------------------------------------------------------------------------------------------
GithubSignIn::AuthorizationsControllerTest: test_configuring_Github_authorization_URL_including_query_param
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://example.com/auth?client_id=1234567890&param=value&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=arb8uHx6U%2F0sef%2BVIwuraIKbstoVxvaM
Completed 302 Found in 0ms (Allocations: 489)
--------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_that_is_not_a_valid_URL
--------------------------------------------------------------------------------------
----------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_double-slash_path_target
----------------------------------------------------------------------------
---------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_allows_absolute_path_target
---------------------------------------------------------------------
--------------------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_with_different_protocol_than_source
--------------------------------------------------------------------------------------------------
------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_relative_path_target
------------------------------------------------------------------------
----------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_triple-slash_path_target
----------------------------------------------------------------------------
--------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_empty_URL_target
--------------------------------------------------------------------
--------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_allows_URL_target_with_same_origin_as_source
--------------------------------------------------------------------------------------
----------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_that_is_blank
----------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_with_different_port_than_source
----------------------------------------------------------------------------------------------
-----------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_invalid_paths
-----------------------------------------------------------------
----------------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_with_different_host_than_source
----------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_invalid_scope
------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=QpDFOK68M5KEjGQOWQ3VFe35q0z3u8C2
Completed 302 Found in 0ms (Allocations: 416)
Started GET "/github_sign_in/callback?error=invalid_scope&state=QpDFOK68M5KEjGQOWQ3VFe35q0z3u8C2" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "invalid_scope", "state" => "QpDFOK68M5KEjGQOWQ3VFe35q0z3u8C2"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (Allocations: 380)
----------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_neither_code_nor_error
----------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=0lHTYW4bskxDQ2cxe5yIH0HQdGcIyBZ5
Completed 302 Found in 0ms (Allocations: 416)
Started GET "/github_sign_in/callback?state=0lHTYW4bskxDQ2cxe5yIH0HQdGcIyBZ5" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"state" => "0lHTYW4bskxDQ2cxe5yIH0HQdGcIyBZ5"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (Allocations: 270)
----------------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_temporarily_unavailable
----------------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=c2wPYtEQSupFZ56%2FyaM%2BmqZ%2F4UlYjf2k
Completed 302 Found in 0ms (Allocations: 444)
Started GET "/github_sign_in/callback?error=temporarily_unavailable&state=c2wPYtEQSupFZ56%2FyaM%2BmqZ%2F4UlYjf2k" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "temporarily_unavailable", "state" => "c2wPYtEQSupFZ56/yaM+mqZ/4UlYjf2k"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (Allocations: 271)
------------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_unauthorized_client
------------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=K8CluKiSnTAf%2FfmbY9wZm2c1UObeos7p
Completed 302 Found in 1ms (Allocations: 426)
Started GET "/github_sign_in/callback?error=unauthorized_client&state=K8CluKiSnTAf%2FfmbY9wZm2c1UObeos7p" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "unauthorized_client", "state" => "K8CluKiSnTAf/fmbY9wZm2c1UObeos7p"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (Allocations: 262)
--------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_invalid_request
--------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=1RJu3gKatppnUJo574bKzdSmwOWco7Ek
Completed 302 Found in 1ms (Allocations: 416)
Started GET "/github_sign_in/callback?error=invalid_request&state=1RJu3gKatppnUJo574bKzdSmwOWco7Ek" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "invalid_request", "state" => "1RJu3gKatppnUJo574bKzdSmwOWco7Ek"}
Redirected to http://www.example.com/login
Completed 302 Found in 1ms (Allocations: 241)
--------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_unauthorized_client
--------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=lhBCps7WKCeo4KehzNINcO5B4WlqvSzm
Completed 302 Found in 1ms (Allocations: 416)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=lhBCps7WKCeo4KehzNINcO5B4WlqvSzm" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "lhBCps7WKCeo4KehzNINcO5B4WlqvSzm"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (Allocations: 2259)
-----------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects_given_a_double-slash_net_path
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "//evil.example.org"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=s%2F8ebm5UOd%2Fp97Ad%2BsU9QQKfCMZfRpax
Completed 302 Found in 0ms (Allocations: 444)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=s%2F8ebm5UOd%2Fp97Ad%2BsU9QQKfCMZfRpax" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "s/8ebm5UOd/p97Ad+sU9QQKfCMZfRpax"}
Redirect target "//evil.example.org" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=s%2F8ebm5UOd%2Fp97Ad%2BsU9QQKfCMZfRpax"
Completed 400 Bad Request in 0ms (Allocations: 266)
-----------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_server_error
-----------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=UDqyu1UrVIXAmQzoa2UVvENYhadEWBUu
Completed 302 Found in 0ms (Allocations: 416)
Started GET "/github_sign_in/callback?error=server_error&state=UDqyu1UrVIXAmQzoa2UVvENYhadEWBUu" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "server_error", "state" => "UDqyu1UrVIXAmQzoa2UVvENYhadEWBUu"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (Allocations: 256)
-----------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_no_proceed_to_URL
-----------------------------------------------------------------------
Started GET "/github_sign_in/callback?code=[FILTERED]&state=invalid" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "invalid"}
Redirect target nil does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=invalid"
Completed 400 Bad Request in 0ms (Allocations: 116)
-----------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_unsupported_grant_type
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=2G2AbEsmCzFJtHpytwHmh%2FtHrU1%2FCzHk
Completed 302 Found in 0ms (Allocations: 435)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=2G2AbEsmCzFJtHpytwHmh%2FtHrU1%2FCzHk" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "2G2AbEsmCzFJtHpytwHmh/tHrU1/CzHk"}
Redirected to http://www.example.com/login
Completed 302 Found in 4ms (Allocations: 1542)
-----------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_accepts_proceed_to_paths_if_they_are_absolute
-----------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=47RZe%2B1Qjng8byi56IhZ2nO9WKKWmGZq
Completed 302 Found in 0ms (Allocations: 426)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=47RZe%2B1Qjng8byi56IhZ2nO9WKKWmGZq" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "47RZe+1Qjng8byi56IhZ2nO9WKKWmGZq"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (Allocations: 2956)
---------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_CSRF_without_flash_state
---------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=%2FPrgRx7BeX6C0LTb1fp%2BkxceQMyV0BRu
Completed 302 Found in 0ms (Allocations: 435)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=invalid" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "invalid"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (Allocations: 264)
--------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_invalid_grant
--------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=yKjg54EmWL04b7xiuK8R5%2Bje3iX21GCM
Completed 302 Found in 0ms (Allocations: 426)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=yKjg54EmWL04b7xiuK8R5%2Bje3iX21GCM" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "yKjg54EmWL04b7xiuK8R5+je3iX21GCM"}
Redirected to http://www.example.com/login
Completed 302 Found in 4ms (Allocations: 1539)
-----------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_rejects_proceed_to_paths_if_they_are_relative
-----------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=zQavhOE0EzrtsAyjxvRwFGrCBl8zvldY
Completed 302 Found in 0ms (Allocations: 416)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=zQavhOE0EzrtsAyjxvRwFGrCBl8zvldY" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "zQavhOE0EzrtsAyjxvRwFGrCBl8zvldY"}
Redirect target "login" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=zQavhOE0EzrtsAyjxvRwFGrCBl8zvldY"
Completed 400 Bad Request in 0ms (Allocations: 209)
---------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects_given_a_malformed_URI
---------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com\\n\\r@\\n\\revil.example.org/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=KF9Ztm4TpoKlacsTx6wRSwM1EApW5oYK
Completed 302 Found in 0ms (Allocations: 416)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=KF9Ztm4TpoKlacsTx6wRSwM1EApW5oYK" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "KF9Ztm4TpoKlacsTx6wRSwM1EApW5oYK"}
Redirect target "http://www.example.com\\n\\r@\\n\\revil.example.org/login" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=KF9Ztm4TpoKlacsTx6wRSwM1EApW5oYK"
Completed 400 Bad Request in 0ms (Allocations: 224)
--------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_CSRF_with_invalid_state
--------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=Py%2F8wVzw06fMvuXJXaIEUmnpFIDJp1NG
Completed 302 Found in 0ms (Allocations: 426)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=invalid" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "invalid"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (Allocations: 270)
------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_access_denied
------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=xU3lPr1x4Hbi%2BhYoe%2FDASpp%2FbtuRzPKs
Completed 302 Found in 0ms (Allocations: 444)
Started GET "/github_sign_in/callback?error=access_denied&state=xU3lPr1x4Hbi%2BhYoe%2FDASpp%2FbtuRzPKs" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "access_denied", "state" => "xU3lPr1x4Hbi+hYoe/DASpp/btuRzPKs"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (Allocations: 262)
---------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code
---------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=VFZhjKgM3WNN4zLxyhNAbc5zAECTWirZ
Completed 302 Found in 0ms (Allocations: 416)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=VFZhjKgM3WNN4zLxyhNAbc5zAECTWirZ" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "VFZhjKgM3WNN4zLxyhNAbc5zAECTWirZ"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (Allocations: 2809)
-----------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects
-----------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://malicious.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=52%2BKhH4wKAneyhVK9o4y14lWxgzIG6OM
Completed 302 Found in 0ms (Allocations: 426)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=52%2BKhH4wKAneyhVK9o4y14lWxgzIG6OM" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "52+KhH4wKAneyhVK9o4y14lWxgzIG6OM"}
Redirect target "http://malicious.example.com/login" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=52%2BKhH4wKAneyhVK9o4y14lWxgzIG6OM"
Completed 400 Bad Request in 0ms (Allocations: 255)
-----------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects_given_a_triple-slash_net_path
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "///evil.example.org"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=yiVZMaGq6t9gBJVvEnjFhDDxhQix2RwH
Completed 302 Found in 0ms (Allocations: 416)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=yiVZMaGq6t9gBJVvEnjFhDDxhQix2RwH" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "yiVZMaGq6t9gBJVvEnjFhDDxhQix2RwH"}
Redirect target "///evil.example.org" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=yiVZMaGq6t9gBJVvEnjFhDDxhQix2RwH"
Completed 400 Bad Request in 0ms (Allocations: 224)
----------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_invalid_request
----------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=%2BtRqqtpBb6yD5O4yNtzWZrCCeoALc4Ou
Completed 302 Found in 0ms (Allocations: 426)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=%2BtRqqtpBb6yD5O4yNtzWZrCCeoALc4Ou" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "+tRqqtpBb6yD5O4yNtzWZrCCeoALc4Ou"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (Allocations: 1542)
---------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_invalid_client
---------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=siLyQeuvbdkABkfEKsA0Kkwk3j2kZAQr
Completed 302 Found in 0ms (Allocations: 416)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=siLyQeuvbdkABkfEKsA0Kkwk3j2kZAQr" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "siLyQeuvbdkABkfEKsA0Kkwk3j2kZAQr"}
Redirected to http://www.example.com/login
Completed 302 Found in 4ms (Allocations: 1539)
--------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_CSRF_with_missing_state
--------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=7t07QbLeTXhcKQ%2FHLjI89%2BaA7v5a59%2Fk
Completed 302 Found in 0ms (Allocations: 444)
Started GET "/github_sign_in/callback?code=[FILTERED]" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (Allocations: 253)
------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_invalid_authorization_error
------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=OP1pjtVeueedxktW42BJf5WzudQSRFLG
Completed 302 Found in 0ms (Allocations: 416)
Started GET "/github_sign_in/callback?error=unknown+error+code&state=OP1pjtVeueedxktW42BJf5WzudQSRFLG" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "unknown error code", "state" => "OP1pjtVeueedxktW42BJf5WzudQSRFLG"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (Allocations: 278)
------------------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_unsupported_response_type
------------------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=U%2F5b6rJNvfaq9uUpjowPUfacHPnfrdEn
Completed 302 Found in 0ms (Allocations: 426)
Started GET "/github_sign_in/callback?error=unsupported_response_type&state=U%2F5b6rJNvfaq9uUpjowPUfacHPnfrdEn" for 127.0.0.1 at 2025-11-05 18:03:22 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "unsupported_response_type", "state" => "U/5b6rJNvfaq9uUpjowPUfacHPnfrdEn"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (Allocations: 262)
-------------------------------------------------------
GithubSignIn::IdentityTest: test_handling_missing_email
-------------------------------------------------------
----------------------------------------------------
GithubSignIn::IdentityTest: test_handling_API_errors
----------------------------------------------------
------------------------------------------------------------
GithubSignIn::IdentityTest: test_extracting_user_information
------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------
GithubSignIn::AuthorizationsControllerTest: test_configuring_Github_authorization_URL_including_query_param
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:23 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://example.com/auth?client_id=1234567890&param=value&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=UyKOBvYbkcTVOBIuiKffUVzFhxIER1Ar
Completed 302 Found in 2ms (GC: 0.0ms)
----------------------------------------------------------------------------------------
GithubSignIn::AuthorizationsControllerTest: test_redirecting_to_Github_for_authorization
----------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:23 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=8SWUK5YwHBGIFl%2BP1CylIGYF4NeweKwU
Completed 302 Found in 0ms (GC: 0.0ms)
-------------------------------------------------------------------------------------
GithubSignIn::ButtonHelperTest: test_generating_a_login_button_with_custom_attributes
-------------------------------------------------------------------------------------
--------------------------------------------------------------------------------
GithubSignIn::ButtonHelperTest: test_generating_a_login_button_with_HTML_content
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
GithubSignIn::ButtonHelperTest: test_generating_a_login_button_with_text_content
--------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_with_different_port_than_source
----------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_with_different_protocol_than_source
--------------------------------------------------------------------------------------------------
---------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_allows_absolute_path_target
---------------------------------------------------------------------
--------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_that_is_not_a_valid_URL
--------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_allows_URL_target_with_same_origin_as_source
--------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_with_different_host_than_source
----------------------------------------------------------------------------------------------
--------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_empty_URL_target
--------------------------------------------------------------------
-----------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_invalid_paths
-----------------------------------------------------------------
----------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_triple-slash_path_target
----------------------------------------------------------------------------
------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_relative_path_target
------------------------------------------------------------------------
----------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_that_is_blank
----------------------------------------------------------------------------
----------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_double-slash_path_target
----------------------------------------------------------------------------
----------------------------------------------------
GithubSignIn::IdentityTest: test_handling_API_errors
----------------------------------------------------
------------------------------------------------------------
GithubSignIn::IdentityTest: test_extracting_user_information
------------------------------------------------------------
-------------------------------------------------------
GithubSignIn::IdentityTest: test_handling_missing_email
-------------------------------------------------------
------------------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_unsupported_response_type
------------------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:23 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=k0KMnmR%2BTHXA%2FZHrkyyCboJzvFwiwTju
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=unsupported_response_type&state=k0KMnmR%2BTHXA%2FZHrkyyCboJzvFwiwTju" for 127.0.0.1 at 2025-11-05 18:03:23 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "unsupported_response_type", "state" => "k0KMnmR+THXA/ZHrkyyCboJzvFwiwTju"}
Redirected to http://www.example.com/login
Completed 302 Found in 1ms (GC: 0.0ms)
---------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_CSRF_without_flash_state
---------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:23 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=Dpy48NoR9ufvM8PA%2FQr7XJv8%2FiejK18d
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=invalid" for 127.0.0.1 at 2025-11-05 18:03:23 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "invalid"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_invalid_scope
------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:23 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=0ggsLFgFStl6%2B2Br6AjcITJlmxGf0fp%2F
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=invalid_scope&state=0ggsLFgFStl6%2B2Br6AjcITJlmxGf0fp%2F" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "invalid_scope", "state" => "0ggsLFgFStl6+2Br6AjcITJlmxGf0fp/"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
---------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects_given_a_malformed_URI
---------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com\\n\\r@\\n\\revil.example.org/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=XJl3l0c4FeHxT0m4opKYZ8zXlYeLncbX
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=XJl3l0c4FeHxT0m4opKYZ8zXlYeLncbX" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "XJl3l0c4FeHxT0m4opKYZ8zXlYeLncbX"}
Redirect target "http://www.example.com\\n\\r@\\n\\revil.example.org/login" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=XJl3l0c4FeHxT0m4opKYZ8zXlYeLncbX"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
--------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_CSRF_with_missing_state
--------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=ZR46D8vqRXUkyWSL%2BNp1IiLeeqsQL6Tj
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_unsupported_grant_type
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=%2FEWP0kxTUWdkqmnK5cVLWPSLHQBmkgws
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=%2FEWP0kxTUWdkqmnK5cVLWPSLHQBmkgws" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "/EWP0kxTUWdkqmnK5cVLWPSLHQBmkgws"}
Redirected to http://www.example.com/login
Completed 302 Found in 4ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_accepts_proceed_to_paths_if_they_are_absolute
-----------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=Vok%2B%2BMnTIJcWWp5Y3R4FYwRqqPbz0Rqp
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=Vok%2B%2BMnTIJcWWp5Y3R4FYwRqqPbz0Rqp" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "Vok++MnTIJcWWp5Y3R4FYwRqqPbz0Rqp"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (GC: 0.0ms)
--------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_invalid_request
--------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=%2FTyEN9kwjqqz%2F%2F6S5JO8aPfLDqr%2FY2hv
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=invalid_request&state=%2FTyEN9kwjqqz%2F%2F6S5JO8aPfLDqr%2FY2hv" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "invalid_request", "state" => "/TyEN9kwjqqz//6S5JO8aPfLDqr/Y2hv"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
----------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_invalid_request
----------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=tfSPJuDUXzxwBWVIZfvgc0wBvYpVYljm
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=tfSPJuDUXzxwBWVIZfvgc0wBvYpVYljm" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "tfSPJuDUXzxwBWVIZfvgc0wBvYpVYljm"}
Redirected to http://www.example.com/login
Completed 302 Found in 4ms (GC: 0.0ms)
-----------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects
-----------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://malicious.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=AOpOsXX5ACnIM%2FRJCOQof%2FvuOnEXQ%2FjB
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=AOpOsXX5ACnIM%2FRJCOQof%2FvuOnEXQ%2FjB" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "AOpOsXX5ACnIM/RJCOQof/vuOnEXQ/jB"}
Redirect target "http://malicious.example.com/login" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=AOpOsXX5ACnIM%2FRJCOQof%2FvuOnEXQ%2FjB"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
--------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_CSRF_with_invalid_state
--------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=IZg0dbZjYR0PdLcTGOhLRgfYM8pPVwCV
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=invalid" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "invalid"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects_given_a_double-slash_net_path
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "//evil.example.org"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=VaOrzpDQGiQJAQigpJDAjC6TKtXlaPZa
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=VaOrzpDQGiQJAQigpJDAjC6TKtXlaPZa" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "VaOrzpDQGiQJAQigpJDAjC6TKtXlaPZa"}
Redirect target "//evil.example.org" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=VaOrzpDQGiQJAQigpJDAjC6TKtXlaPZa"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
--------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_invalid_grant
--------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=Dgc9FcEbF87nuHToWAPWjR0XGR9gaXse
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=Dgc9FcEbF87nuHToWAPWjR0XGR9gaXse" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "Dgc9FcEbF87nuHToWAPWjR0XGR9gaXse"}
Redirected to http://www.example.com/login
Completed 302 Found in 4ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_server_error
-----------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=jcuN%2B9JS1ybNTA1sLoDlRks%2FbBXU9UiZ
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=server_error&state=jcuN%2B9JS1ybNTA1sLoDlRks%2FbBXU9UiZ" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "server_error", "state" => "jcuN+9JS1ybNTA1sLoDlRks/bBXU9UiZ"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_invalid_authorization_error
------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=enESvpRJHCw03pqQIkyJ7wiYgspgy8p8
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=unknown+error+code&state=enESvpRJHCw03pqQIkyJ7wiYgspgy8p8" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "unknown error code", "state" => "enESvpRJHCw03pqQIkyJ7wiYgspgy8p8"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
--------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_unauthorized_client
--------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=YiKFcxFahlU3Rn0SG%2BS7AP6vf0OV1i1G
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=YiKFcxFahlU3Rn0SG%2BS7AP6vf0OV1i1G" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "YiKFcxFahlU3Rn0SG+S7AP6vf0OV1i1G"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (GC: 0.0ms)
---------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_invalid_client
---------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=inkGmvtRrk4eHqllo1rFCTTNPrlsJAI2
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=inkGmvtRrk4eHqllo1rFCTTNPrlsJAI2" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "inkGmvtRrk4eHqllo1rFCTTNPrlsJAI2"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (GC: 0.0ms)
---------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code
---------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=mHPjyxWyymk0bKVzfYbsApsXP53GZ8Yr
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=mHPjyxWyymk0bKVzfYbsApsXP53GZ8Yr" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "mHPjyxWyymk0bKVzfYbsApsXP53GZ8Yr"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (GC: 0.0ms)
------------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_unauthorized_client
------------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=PR4uEKwFL6VPsv90uxbgYlahy1ELXidx
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=unauthorized_client&state=PR4uEKwFL6VPsv90uxbgYlahy1ELXidx" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "unauthorized_client", "state" => "PR4uEKwFL6VPsv90uxbgYlahy1ELXidx"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_access_denied
------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=i5iZIYhLR%2F%2FpTsHbHyNr33iZq8xzRf2%2B
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=access_denied&state=i5iZIYhLR%2F%2FpTsHbHyNr33iZq8xzRf2%2B" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "access_denied", "state" => "i5iZIYhLR//pTsHbHyNr33iZq8xzRf2+"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
----------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_neither_code_nor_error
----------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=Jxe8mXYSqUxGIOVJQ8JEce8EBQ8eUXcD
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?state=Jxe8mXYSqUxGIOVJQ8JEce8EBQ8eUXcD" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"state" => "Jxe8mXYSqUxGIOVJQ8JEce8EBQ8eUXcD"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects_given_a_triple-slash_net_path
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "///evil.example.org"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=AAiTXbYe%2BIIG6sY7iA2a%2B1XWtZAkv3OT
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=AAiTXbYe%2BIIG6sY7iA2a%2B1XWtZAkv3OT" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "AAiTXbYe+IIG6sY7iA2a+1XWtZAkv3OT"}
Redirect target "///evil.example.org" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=AAiTXbYe%2BIIG6sY7iA2a%2B1XWtZAkv3OT"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_rejects_proceed_to_paths_if_they_are_relative
-----------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=Woa1A5fCB9B%2FFjDh62hV3G6O9iTSLUSf
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=Woa1A5fCB9B%2FFjDh62hV3G6O9iTSLUSf" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "Woa1A5fCB9B/FjDh62hV3G6O9iTSLUSf"}
Redirect target "login" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=Woa1A5fCB9B%2FFjDh62hV3G6O9iTSLUSf"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
----------------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_temporarily_unavailable
----------------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=90Lhw7E6hvCFNi2T%2F89zBN6OEfvaZ%2BUF
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=temporarily_unavailable&state=90Lhw7E6hvCFNi2T%2F89zBN6OEfvaZ%2BUF" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "temporarily_unavailable", "state" => "90Lhw7E6hvCFNi2T/89zBN6OEfvaZ+UF"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_no_proceed_to_URL
-----------------------------------------------------------------------
Started GET "/github_sign_in/callback?code=[FILTERED]&state=invalid" for 127.0.0.1 at 2025-11-05 18:03:24 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "invalid"}
Redirect target nil does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=invalid"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
----------------------------------------------------
GithubSignIn::IdentityTest: test_handling_API_errors
----------------------------------------------------
------------------------------------------------------------
GithubSignIn::IdentityTest: test_extracting_user_information
------------------------------------------------------------
-------------------------------------------------------
GithubSignIn::IdentityTest: test_handling_missing_email
-------------------------------------------------------
-------------------------------------------------------------------------------------
GithubSignIn::ButtonHelperTest: test_generating_a_login_button_with_custom_attributes
-------------------------------------------------------------------------------------
--------------------------------------------------------------------------------
GithubSignIn::ButtonHelperTest: test_generating_a_login_button_with_HTML_content
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
GithubSignIn::ButtonHelperTest: test_generating_a_login_button_with_text_content
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_unauthorized_client
--------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=ZSke85uota0HfDa26EbkvAWMLabLWZEt
Completed 302 Found in 2ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=ZSke85uota0HfDa26EbkvAWMLabLWZEt" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "ZSke85uota0HfDa26EbkvAWMLabLWZEt"}
Redirected to http://www.example.com/login
Completed 302 Found in 6ms (GC: 0.0ms)
-----------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_no_proceed_to_URL
-----------------------------------------------------------------------
Started GET "/github_sign_in/callback?code=[FILTERED]&state=invalid" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "invalid"}
Redirect target nil does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=invalid"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
------------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_unauthorized_client
------------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=XHucngAbaJ9Fyo7oXNM1nTIJVTyX76hb
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=unauthorized_client&state=XHucngAbaJ9Fyo7oXNM1nTIJVTyX76hb" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "unauthorized_client", "state" => "XHucngAbaJ9Fyo7oXNM1nTIJVTyX76hb"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_accepts_proceed_to_paths_if_they_are_absolute
-----------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=egMDNJYwJUTrQcKNV7jD0u%2BTrgMhcCAU
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=egMDNJYwJUTrQcKNV7jD0u%2BTrgMhcCAU" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "egMDNJYwJUTrQcKNV7jD0u+TrgMhcCAU"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (GC: 0.0ms)
-----------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects
-----------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://malicious.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=hxtdNJFRqIbLHBbFqEeTecpt85TDqunG
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=hxtdNJFRqIbLHBbFqEeTecpt85TDqunG" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "hxtdNJFRqIbLHBbFqEeTecpt85TDqunG"}
Redirect target "http://malicious.example.com/login" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=hxtdNJFRqIbLHBbFqEeTecpt85TDqunG"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
--------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_CSRF_with_invalid_state
--------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=5Zl59LDbkkMO6SE3gUWuiLzZc%2Bu7%2BfvU
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=invalid" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "invalid"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects_given_a_triple-slash_net_path
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "///evil.example.org"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=E49odYczDu9jvDkF2et8SeH%2B7G0AEghg
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=E49odYczDu9jvDkF2et8SeH%2B7G0AEghg" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "E49odYczDu9jvDkF2et8SeH+7G0AEghg"}
Redirect target "///evil.example.org" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=E49odYczDu9jvDkF2et8SeH%2B7G0AEghg"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
----------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_neither_code_nor_error
----------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=%2BQ%2F4Td0zMaTVtP7LhAQq6pisHK3OgOms
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?state=%2BQ%2F4Td0zMaTVtP7LhAQq6pisHK3OgOms" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"state" => "+Q/4Td0zMaTVtP7LhAQq6pisHK3OgOms"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_rejects_proceed_to_paths_if_they_are_relative
-----------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=ppmugrhTmJiSSXYw37x0YaagFP%2FGqsMv
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=ppmugrhTmJiSSXYw37x0YaagFP%2FGqsMv" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "ppmugrhTmJiSSXYw37x0YaagFP/GqsMv"}
Redirect target "login" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=ppmugrhTmJiSSXYw37x0YaagFP%2FGqsMv"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
--------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_invalid_request
--------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=n2sOZB7xnN4k93ykoM7%2FyOlLOBdCIC4a
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=invalid_request&state=n2sOZB7xnN4k93ykoM7%2FyOlLOBdCIC4a" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "invalid_request", "state" => "n2sOZB7xnN4k93ykoM7/yOlLOBdCIC4a"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
---------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code
---------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=zW0rsiqK1Vc3c2btKdb1iiNzKrC2Ym6K
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=zW0rsiqK1Vc3c2btKdb1iiNzKrC2Ym6K" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "zW0rsiqK1Vc3c2btKdb1iiNzKrC2Ym6K"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_unsupported_grant_type
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=GyyDR00CLeAyjQjp8cdjJTpFG3Z7KZUf
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=GyyDR00CLeAyjQjp8cdjJTpFG3Z7KZUf" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "GyyDR00CLeAyjQjp8cdjJTpFG3Z7KZUf"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (GC: 0.0ms)
--------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_invalid_grant
--------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=TrPmwOgvzFAxwBK%2BKaEyitd5eV%2BQee6%2F
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=TrPmwOgvzFAxwBK%2BKaEyitd5eV%2BQee6%2F" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "TrPmwOgvzFAxwBK+KaEyitd5eV+Qee6/"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (GC: 0.0ms)
----------------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_temporarily_unavailable
----------------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=J2I7K6tKnuUUXzxVVGJrEi52ztX3peRS
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=temporarily_unavailable&state=J2I7K6tKnuUUXzxVVGJrEi52ztX3peRS" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "temporarily_unavailable", "state" => "J2I7K6tKnuUUXzxVVGJrEi52ztX3peRS"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects_given_a_double-slash_net_path
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "//evil.example.org"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=%2BGml025gtcslLXK22KWfpDUKQ0f5436C
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=%2BGml025gtcslLXK22KWfpDUKQ0f5436C" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "+Gml025gtcslLXK22KWfpDUKQ0f5436C"}
Redirect target "//evil.example.org" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=%2BGml025gtcslLXK22KWfpDUKQ0f5436C"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_invalid_authorization_error
------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=hDRb5l%2BWhJw%2BzEpfBQG0GcVfnnoM%2BRzU
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=unknown+error+code&state=hDRb5l%2BWhJw%2BzEpfBQG0GcVfnnoM%2BRzU" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "unknown error code", "state" => "hDRb5l+WhJw+zEpfBQG0GcVfnnoM+RzU"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
----------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_invalid_request
----------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=GR65tsLk3awNoUFs%2FsZXHVALzxt%2FXjL%2B
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=GR65tsLk3awNoUFs%2FsZXHVALzxt%2FXjL%2B" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "GR65tsLk3awNoUFs/sZXHVALzxt/XjL+"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (GC: 0.0ms)
--------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_CSRF_with_missing_state
--------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=a0F1svv%2BIJsD9VhVrQYr5cRWSY7ZubBS
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
---------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_invalid_client
---------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=wCII9HjrVi9lKjt6F8aM7wmN27F06vo4
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=wCII9HjrVi9lKjt6F8aM7wmN27F06vo4" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "wCII9HjrVi9lKjt6F8aM7wmN27F06vo4"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (GC: 0.0ms)
------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_invalid_scope
------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=hQSo5bX%2BE4U4HmrFEDIdnVRGF9dSx1SG
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=invalid_scope&state=hQSo5bX%2BE4U4HmrFEDIdnVRGF9dSx1SG" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "invalid_scope", "state" => "hQSo5bX+E4U4HmrFEDIdnVRGF9dSx1SG"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_server_error
-----------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=1%2FlYg9wS0C35l1wdLh2dHV9UFrveutub
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=server_error&state=1%2FlYg9wS0C35l1wdLh2dHV9UFrveutub" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "server_error", "state" => "1/lYg9wS0C35l1wdLh2dHV9UFrveutub"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_access_denied
------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=FSHFtByPlEC%2BuN4EiXf330lqiKSB%2FB5X
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=access_denied&state=FSHFtByPlEC%2BuN4EiXf330lqiKSB%2FB5X" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "access_denied", "state" => "FSHFtByPlEC+uN4EiXf330lqiKSB/B5X"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
---------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_CSRF_without_flash_state
---------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=Qt%2F61xe1IrzVfTHlo%2FhvjZbL7sS2XX%2FX
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=invalid" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "invalid"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
------------------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_unsupported_response_type
------------------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=FOtGQaV0SdR9j5X1StfsTFm%2BXLM0LAvR
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=unsupported_response_type&state=FOtGQaV0SdR9j5X1StfsTFm%2BXLM0LAvR" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "unsupported_response_type", "state" => "FOtGQaV0SdR9j5X1StfsTFm+XLM0LAvR"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
---------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects_given_a_malformed_URI
---------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com\\n\\r@\\n\\revil.example.org/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=Ut2QEmjmq4qwlKj5c6T4CftSW1CT%2FYUR
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=Ut2QEmjmq4qwlKj5c6T4CftSW1CT%2FYUR" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "Ut2QEmjmq4qwlKj5c6T4CftSW1CT/YUR"}
Redirect target "http://www.example.com\\n\\r@\\n\\revil.example.org/login" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=Ut2QEmjmq4qwlKj5c6T4CftSW1CT%2FYUR"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
----------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_double-slash_path_target
----------------------------------------------------------------------------
------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_relative_path_target
------------------------------------------------------------------------
-----------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_invalid_paths
-----------------------------------------------------------------
----------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_that_is_blank
----------------------------------------------------------------------------
--------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_empty_URL_target
--------------------------------------------------------------------
----------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_triple-slash_path_target
----------------------------------------------------------------------------
--------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_allows_URL_target_with_same_origin_as_source
--------------------------------------------------------------------------------------
---------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_allows_absolute_path_target
---------------------------------------------------------------------
----------------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_with_different_port_than_source
----------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_that_is_not_a_valid_URL
--------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_with_different_host_than_source
----------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_with_different_protocol_than_source
--------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------
GithubSignIn::AuthorizationsControllerTest: test_redirecting_to_Github_for_authorization
----------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=4hmp8V9P1SC69%2FU1l3tFhdWykexnI66V
Completed 302 Found in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------------
GithubSignIn::AuthorizationsControllerTest: test_configuring_Github_authorization_URL_including_query_param
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:25 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://example.com/auth?client_id=1234567890&param=value&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=PSBIQ8cGwLEwrHiO5uEJCaFQFMwPzz4L
Completed 302 Found in 0ms (GC: 0.0ms)
-------------------------------------------------------
GithubSignIn::IdentityTest: test_handling_missing_email
-------------------------------------------------------
----------------------------------------------------
GithubSignIn::IdentityTest: test_handling_API_errors
----------------------------------------------------
------------------------------------------------------------
GithubSignIn::IdentityTest: test_extracting_user_information
------------------------------------------------------------
----------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_triple-slash_path_target
----------------------------------------------------------------------------
----------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_that_is_blank
----------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_with_different_host_than_source
----------------------------------------------------------------------------------------------
------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_relative_path_target
------------------------------------------------------------------------
--------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_allows_URL_target_with_same_origin_as_source
--------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_with_different_port_than_source
----------------------------------------------------------------------------------------------
---------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_allows_absolute_path_target
---------------------------------------------------------------------
--------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_that_is_not_a_valid_URL
--------------------------------------------------------------------------------------
-----------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_invalid_paths
-----------------------------------------------------------------
--------------------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_with_different_protocol_than_source
--------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_double-slash_path_target
----------------------------------------------------------------------------
--------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_empty_URL_target
--------------------------------------------------------------------
----------------------------------------------------------------------------------------
GithubSignIn::AuthorizationsControllerTest: test_redirecting_to_Github_for_authorization
----------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=P0VSStjqQ1UUeNWVXbA4KT2aJNgtGFDE
Completed 302 Found in 2ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------------
GithubSignIn::AuthorizationsControllerTest: test_configuring_Github_authorization_URL_including_query_param
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://example.com/auth?client_id=1234567890&param=value&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=%2B1v7Tl0sCYhMPwgT6zgiXP%2Fz0pgHWMMJ
Completed 302 Found in 0ms (GC: 0.0ms)
------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_access_denied
------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=iLGsB3Ri%2BB5bedGk31Im8w5Dz6hli6IR
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=access_denied&state=iLGsB3Ri%2BB5bedGk31Im8w5Dz6hli6IR" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "access_denied", "state" => "iLGsB3Ri+B5bedGk31Im8w5Dz6hli6IR"}
Redirected to http://www.example.com/login
Completed 302 Found in 1ms (GC: 0.0ms)
----------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_invalid_request
----------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=FDnBUG3dAstvpByo7fruApcuxIG%2FBvKh
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=FDnBUG3dAstvpByo7fruApcuxIG%2FBvKh" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "FDnBUG3dAstvpByo7fruApcuxIG/BvKh"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (GC: 0.0ms)
--------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_invalid_request
--------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=E%2Bv3fkD6%2FMqdHTG13TPpZcaVz%2FheuNxp
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=invalid_request&state=E%2Bv3fkD6%2FMqdHTG13TPpZcaVz%2FheuNxp" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "invalid_request", "state" => "E+v3fkD6/MqdHTG13TPpZcaVz/heuNxp"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
----------------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_temporarily_unavailable
----------------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=8rfetv1DTfJPAJ25DjPFiJW7JZ33O57P
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=temporarily_unavailable&state=8rfetv1DTfJPAJ25DjPFiJW7JZ33O57P" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "temporarily_unavailable", "state" => "8rfetv1DTfJPAJ25DjPFiJW7JZ33O57P"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
--------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_invalid_grant
--------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=r3Q9FhOxRouT0DuwXJBndI3VecljQ9n9
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=r3Q9FhOxRouT0DuwXJBndI3VecljQ9n9" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "r3Q9FhOxRouT0DuwXJBndI3VecljQ9n9"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (GC: 0.0ms)
--------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_CSRF_with_invalid_state
--------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=f41uku9sr79%2FKucbWJtUkz9bT%2Bb68Rlt
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=invalid" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "invalid"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_server_error
-----------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=kPVALF0EimxZu8Ar%2BHl8c5OM7ALxhhmX
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=server_error&state=kPVALF0EimxZu8Ar%2BHl8c5OM7ALxhhmX" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "server_error", "state" => "kPVALF0EimxZu8Ar+Hl8c5OM7ALxhhmX"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
---------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code
---------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=nSoBxaRZRLkSPzc3k2CVsgBPJX229atM
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=nSoBxaRZRLkSPzc3k2CVsgBPJX229atM" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "nSoBxaRZRLkSPzc3k2CVsgBPJX229atM"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects_given_a_double-slash_net_path
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "//evil.example.org"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=eT%2BsowZ5xif7RVBZa4bofdh6M6tlmKxk
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=eT%2BsowZ5xif7RVBZa4bofdh6M6tlmKxk" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "eT+sowZ5xif7RVBZa4bofdh6M6tlmKxk"}
Redirect target "//evil.example.org" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=eT%2BsowZ5xif7RVBZa4bofdh6M6tlmKxk"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects
-----------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://malicious.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=ZwUWmI36Azt6RN%2FXMbWN69zXhtsifpkV
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=ZwUWmI36Azt6RN%2FXMbWN69zXhtsifpkV" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "ZwUWmI36Azt6RN/XMbWN69zXhtsifpkV"}
Redirect target "http://malicious.example.com/login" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=ZwUWmI36Azt6RN%2FXMbWN69zXhtsifpkV"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_no_proceed_to_URL
-----------------------------------------------------------------------
Started GET "/github_sign_in/callback?code=[FILTERED]&state=invalid" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "invalid"}
Redirect target nil does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=invalid"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_invalid_scope
------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=7d2fVo7oEtRbbHLSB0Mg6vQafYvUTdux
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=invalid_scope&state=7d2fVo7oEtRbbHLSB0Mg6vQafYvUTdux" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "invalid_scope", "state" => "7d2fVo7oEtRbbHLSB0Mg6vQafYvUTdux"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
---------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_invalid_client
---------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=KVgi7deANJ5zkXWkpZBPYiLVFniu4HoX
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=KVgi7deANJ5zkXWkpZBPYiLVFniu4HoX" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "KVgi7deANJ5zkXWkpZBPYiLVFniu4HoX"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (GC: 0.0ms)
----------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_neither_code_nor_error
----------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=e4CezQ3w9IV%2Bt2pY2GxVuaRylewLxQZ%2F
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?state=e4CezQ3w9IV%2Bt2pY2GxVuaRylewLxQZ%2F" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"state" => "e4CezQ3w9IV+t2pY2GxVuaRylewLxQZ/"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_invalid_authorization_error
------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=HSt1uJBsWZhVwRUOEW2WWJ6pvmm6Ab%2F8
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=unknown+error+code&state=HSt1uJBsWZhVwRUOEW2WWJ6pvmm6Ab%2F8" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "unknown error code", "state" => "HSt1uJBsWZhVwRUOEW2WWJ6pvmm6Ab/8"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
------------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_unauthorized_client
------------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=DnywYggW6169k3o3R3CpOQLkoUCgmWEM
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=unauthorized_client&state=DnywYggW6169k3o3R3CpOQLkoUCgmWEM" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "unauthorized_client", "state" => "DnywYggW6169k3o3R3CpOQLkoUCgmWEM"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_unsupported_grant_type
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=Oxn973U3mxNzPwJ1uR6T%2Fm0rUjAy8olH
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=Oxn973U3mxNzPwJ1uR6T%2Fm0rUjAy8olH" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "Oxn973U3mxNzPwJ1uR6T/m0rUjAy8olH"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (GC: 0.0ms)
--------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_CSRF_with_missing_state
--------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=kWBu29Axlc1akLJ8BC6ep7WhhF%2BKWuQC
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
------------------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_unsupported_response_type
------------------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=%2BEQP8OPo218eUQ7OjZdY8PyiJwf6MoAQ
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=unsupported_response_type&state=%2BEQP8OPo218eUQ7OjZdY8PyiJwf6MoAQ" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "unsupported_response_type", "state" => "+EQP8OPo218eUQ7OjZdY8PyiJwf6MoAQ"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
--------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_unauthorized_client
--------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=fMrshA97EYc4PO8JfPPIICE%2BPDDWPBoD
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=fMrshA97EYc4PO8JfPPIICE%2BPDDWPBoD" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "fMrshA97EYc4PO8JfPPIICE+PDDWPBoD"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_accepts_proceed_to_paths_if_they_are_absolute
-----------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=l0bbGAcNt%2FJU4emNBbKlZvG4T%2BmyeJal
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=l0bbGAcNt%2FJU4emNBbKlZvG4T%2BmyeJal" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "l0bbGAcNt/JU4emNBbKlZvG4T+myeJal"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (GC: 0.0ms)
---------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_CSRF_without_flash_state
---------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=8A4430x2G4urxXDZ8Q1AL5Z6toTfl2bh
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=invalid" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "invalid"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
---------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects_given_a_malformed_URI
---------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com\\n\\r@\\n\\revil.example.org/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=RwgJ5T72rXTgm5%2BmuzQI4jRPOSCBOgP5
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=RwgJ5T72rXTgm5%2BmuzQI4jRPOSCBOgP5" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "RwgJ5T72rXTgm5+muzQI4jRPOSCBOgP5"}
Redirect target "http://www.example.com\\n\\r@\\n\\revil.example.org/login" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=RwgJ5T72rXTgm5%2BmuzQI4jRPOSCBOgP5"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects_given_a_triple-slash_net_path
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "///evil.example.org"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=19KL5eSeSzb2mWXIt8E7zd3f%2FpXwShAt
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=19KL5eSeSzb2mWXIt8E7zd3f%2FpXwShAt" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "19KL5eSeSzb2mWXIt8E7zd3f/pXwShAt"}
Redirect target "///evil.example.org" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=19KL5eSeSzb2mWXIt8E7zd3f%2FpXwShAt"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_rejects_proceed_to_paths_if_they_are_relative
-----------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=SkJxLwYCtRk89OSy9OFr8ThXOfQhMPm6
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=SkJxLwYCtRk89OSy9OFr8ThXOfQhMPm6" for 127.0.0.1 at 2025-11-05 18:03:26 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "SkJxLwYCtRk89OSy9OFr8ThXOfQhMPm6"}
Redirect target "login" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=SkJxLwYCtRk89OSy9OFr8ThXOfQhMPm6"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
--------------------------------------------------------------------------------
GithubSignIn::ButtonHelperTest: test_generating_a_login_button_with_text_content
--------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
GithubSignIn::ButtonHelperTest: test_generating_a_login_button_with_custom_attributes
-------------------------------------------------------------------------------------
--------------------------------------------------------------------------------
GithubSignIn::ButtonHelperTest: test_generating_a_login_button_with_HTML_content
--------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
GithubSignIn::ButtonHelperTest: test_generating_a_login_button_with_custom_attributes
-------------------------------------------------------------------------------------
--------------------------------------------------------------------------------
GithubSignIn::ButtonHelperTest: test_generating_a_login_button_with_HTML_content
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
GithubSignIn::ButtonHelperTest: test_generating_a_login_button_with_text_content
--------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_invalid_client
---------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=ldROcTVEYsIU%2FyNL2nI9xmmvtbJ7tvON
Completed 302 Found in 2ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=ldROcTVEYsIU%2FyNL2nI9xmmvtbJ7tvON" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "ldROcTVEYsIU/yNL2nI9xmmvtbJ7tvON"}
Redirected to http://www.example.com/login
Completed 302 Found in 6ms (GC: 0.0ms)
------------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_unauthorized_client
------------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=%2FNcpRJcmPi0xsIBQQOj1whcVWhs7pjKR
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=unauthorized_client&state=%2FNcpRJcmPi0xsIBQQOj1whcVWhs7pjKR" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "unauthorized_client", "state" => "/NcpRJcmPi0xsIBQQOj1whcVWhs7pjKR"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_invalid_authorization_error
------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=iA7AYuEOTV2Rx%2FyHnX501pQUm8a1Sq5Y
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=unknown+error+code&state=iA7AYuEOTV2Rx%2FyHnX501pQUm8a1Sq5Y" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "unknown error code", "state" => "iA7AYuEOTV2Rx/yHnX501pQUm8a1Sq5Y"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
----------------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_temporarily_unavailable
----------------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=1lgzl8V%2FzT4dq6Rt47MXuGuRgqIuqkIL
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=temporarily_unavailable&state=1lgzl8V%2FzT4dq6Rt47MXuGuRgqIuqkIL" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "temporarily_unavailable", "state" => "1lgzl8V/zT4dq6Rt47MXuGuRgqIuqkIL"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
--------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_unauthorized_client
--------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=KkUAqYFJiMfHqwRb%2F7EnHztj0Pm5k2Od
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=KkUAqYFJiMfHqwRb%2F7EnHztj0Pm5k2Od" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "KkUAqYFJiMfHqwRb/7EnHztj0Pm5k2Od"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (GC: 0.0ms)
------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_access_denied
------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=lj1qbEFf989kKnVb3qNkcg050anSSPft
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=access_denied&state=lj1qbEFf989kKnVb3qNkcg050anSSPft" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "access_denied", "state" => "lj1qbEFf989kKnVb3qNkcg050anSSPft"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_accepts_proceed_to_paths_if_they_are_absolute
-----------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=I1lL8J%2FvLF5KhmXA90y%2BNmJSMSiNNybw
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=I1lL8J%2FvLF5KhmXA90y%2BNmJSMSiNNybw" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "I1lL8J/vLF5KhmXA90y+NmJSMSiNNybw"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_server_error
-----------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=v7UL02Zpxsjribpa4R9KWRyjZa9HUJVB
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=server_error&state=v7UL02Zpxsjribpa4R9KWRyjZa9HUJVB" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "server_error", "state" => "v7UL02Zpxsjribpa4R9KWRyjZa9HUJVB"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
---------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code
---------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=g7Iyfc%2Fffclt%2BaOr9MWcaM490D7uMpKl
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=g7Iyfc%2Fffclt%2BaOr9MWcaM490D7uMpKl" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "g7Iyfc/ffclt+aOr9MWcaM490D7uMpKl"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (GC: 0.0ms)
----------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_neither_code_nor_error
----------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=K03DtRPMDIQj66SB%2B48deK9ydszE%2BSVB
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?state=K03DtRPMDIQj66SB%2B48deK9ydszE%2BSVB" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"state" => "K03DtRPMDIQj66SB+48deK9ydszE+SVB"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_unsupported_grant_type
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=xZFRehlkQ2j%2BVGQ8%2Byfp3R1WtxBT7PTK
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=xZFRehlkQ2j%2BVGQ8%2Byfp3R1WtxBT7PTK" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "xZFRehlkQ2j+VGQ8+yfp3R1WtxBT7PTK"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (GC: 0.0ms)
------------------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_unsupported_response_type
------------------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=qE3KUJmNgpFPpkihUgLk6Ynj1opvgXaO
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=unsupported_response_type&state=qE3KUJmNgpFPpkihUgLk6Ynj1opvgXaO" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "unsupported_response_type", "state" => "qE3KUJmNgpFPpkihUgLk6Ynj1opvgXaO"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
--------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_invalid_grant
--------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=LvqFza7R4xEYqUKE9tjPedNl68wzME5v
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=LvqFza7R4xEYqUKE9tjPedNl68wzME5v" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "LvqFza7R4xEYqUKE9tjPedNl68wzME5v"}
Redirected to http://www.example.com/login
Completed 302 Found in 4ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects_given_a_triple-slash_net_path
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "///evil.example.org"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=3dbOaL8IF7x3X5YekHMMaUZUPmzyRVkO
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=3dbOaL8IF7x3X5YekHMMaUZUPmzyRVkO" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "3dbOaL8IF7x3X5YekHMMaUZUPmzyRVkO"}
Redirect target "///evil.example.org" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=3dbOaL8IF7x3X5YekHMMaUZUPmzyRVkO"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
--------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_invalid_request
--------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=aLMu%2BV5%2FZKj3iZSXHZiKugORRVTN8v%2FO
Completed 302 Found in 1ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=invalid_request&state=aLMu%2BV5%2FZKj3iZSXHZiKugORRVTN8v%2FO" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "invalid_request", "state" => "aLMu+V5/ZKj3iZSXHZiKugORRVTN8v/O"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_invalid_scope
------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=uoXBEjDXaqUKjSZzLpEXCxRuuF8OPLWF
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=invalid_scope&state=uoXBEjDXaqUKjSZzLpEXCxRuuF8OPLWF" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "invalid_scope", "state" => "uoXBEjDXaqUKjSZzLpEXCxRuuF8OPLWF"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_rejects_proceed_to_paths_if_they_are_relative
-----------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=wPzGtqbRx0kZlPmOz7EO6Z5HZFp6sYL4
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=wPzGtqbRx0kZlPmOz7EO6Z5HZFp6sYL4" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "wPzGtqbRx0kZlPmOz7EO6Z5HZFp6sYL4"}
Redirect target "login" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=wPzGtqbRx0kZlPmOz7EO6Z5HZFp6sYL4"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
---------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_CSRF_without_flash_state
---------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=tuKxUhx%2FzbdySu3dnRFZI1BZm%2F7WmYZ5
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=invalid" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "invalid"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
--------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_CSRF_with_invalid_state
--------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=i%2FtanE1QKu%2BopoQ9mgNDxeGu1j42j7w9
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=invalid" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "invalid"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects_given_a_double-slash_net_path
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "//evil.example.org"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=OZ%2F8n14LMbi8oknMoM%2FRy22JUj10Mnzt
Completed 302 Found in 1ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=OZ%2F8n14LMbi8oknMoM%2FRy22JUj10Mnzt" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "OZ/8n14LMbi8oknMoM/Ry22JUj10Mnzt"}
Redirect target "//evil.example.org" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=OZ%2F8n14LMbi8oknMoM%2FRy22JUj10Mnzt"
Completed 400 Bad Request in 0ms (GC: 0.2ms)
-----------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects
-----------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://malicious.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=WzGcNAugsr07vRipIUTn0lYXjxFvddFD
Completed 302 Found in 1ms (GC: 1.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=WzGcNAugsr07vRipIUTn0lYXjxFvddFD" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "WzGcNAugsr07vRipIUTn0lYXjxFvddFD"}
Redirect target "http://malicious.example.com/login" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=WzGcNAugsr07vRipIUTn0lYXjxFvddFD"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_no_proceed_to_URL
-----------------------------------------------------------------------
Started GET "/github_sign_in/callback?code=[FILTERED]&state=invalid" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "invalid"}
Redirect target nil does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=invalid"
Completed 400 Bad Request in 1ms (GC: 0.6ms)
---------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects_given_a_malformed_URI
---------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com\\n\\r@\\n\\revil.example.org/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=Fqp%2BVMSZozc4H0mGnlypHQXhN9DmbaE1
Completed 302 Found in 1ms (GC: 0.9ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=Fqp%2BVMSZozc4H0mGnlypHQXhN9DmbaE1" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "Fqp+VMSZozc4H0mGnlypHQXhN9DmbaE1"}
Redirect target "http://www.example.com\\n\\r@\\n\\revil.example.org/login" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=Fqp%2BVMSZozc4H0mGnlypHQXhN9DmbaE1"
Completed 400 Bad Request in 0ms (GC: 0.1ms)
----------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_invalid_request
----------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=lMkbr%2FsldGzl8H4AFllUK%2FrKMw30njHg
Completed 302 Found in 1ms (GC: 0.4ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=lMkbr%2FsldGzl8H4AFllUK%2FrKMw30njHg" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "lMkbr/sldGzl8H4AFllUK/rKMw30njHg"}
Redirected to http://www.example.com/login
Completed 302 Found in 7ms (GC: 1.7ms)
--------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_CSRF_with_missing_state
--------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=1feBV4%2B6ag%2Fx4vKsGs25Ys6x%2BkFIVE8v
Completed 302 Found in 1ms (GC: 0.3ms)
Started GET "/github_sign_in/callback?code=[FILTERED]" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]"}
Redirected to http://www.example.com/login
Completed 302 Found in 1ms (GC: 0.6ms)
--------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_empty_URL_target
--------------------------------------------------------------------
--------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_allows_URL_target_with_same_origin_as_source
--------------------------------------------------------------------------------------
----------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_double-slash_path_target
----------------------------------------------------------------------------
--------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_that_is_not_a_valid_URL
--------------------------------------------------------------------------------------
---------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_allows_absolute_path_target
---------------------------------------------------------------------
----------------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_with_different_port_than_source
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_with_different_host_than_source
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_triple-slash_path_target
----------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_with_different_protocol_than_source
--------------------------------------------------------------------------------------------------
-----------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_invalid_paths
-----------------------------------------------------------------
------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_relative_path_target
------------------------------------------------------------------------
----------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_that_is_blank
----------------------------------------------------------------------------
----------------------------------------------------------------------------------------
GithubSignIn::AuthorizationsControllerTest: test_redirecting_to_Github_for_authorization
----------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=bkhIOW0LaXEDuG3rrOqltnDD2ny6Laq4
Completed 302 Found in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------------
GithubSignIn::AuthorizationsControllerTest: test_configuring_Github_authorization_URL_including_query_param
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:27 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://example.com/auth?client_id=1234567890&param=value&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=Oetely0QkDv9VoSpZ1dritGwMdMyyapn
Completed 302 Found in 0ms (GC: 0.0ms)
----------------------------------------------------
GithubSignIn::IdentityTest: test_handling_API_errors
----------------------------------------------------
------------------------------------------------------------
GithubSignIn::IdentityTest: test_extracting_user_information
------------------------------------------------------------
-------------------------------------------------------
GithubSignIn::IdentityTest: test_handling_missing_email
-------------------------------------------------------
-------------------------------------------------------------------------------------
GithubSignIn::ButtonHelperTest: test_generating_a_login_button_with_custom_attributes
-------------------------------------------------------------------------------------
--------------------------------------------------------------------------------
GithubSignIn::ButtonHelperTest: test_generating_a_login_button_with_text_content
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
GithubSignIn::ButtonHelperTest: test_generating_a_login_button_with_HTML_content
--------------------------------------------------------------------------------
----------------------------------------------------------------------------------------
GithubSignIn::AuthorizationsControllerTest: test_redirecting_to_Github_for_authorization
----------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=5ayHveaUWfKwyhRAXj9f9xszXZY6sPXr
Completed 302 Found in 2ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------------
GithubSignIn::AuthorizationsControllerTest: test_configuring_Github_authorization_URL_including_query_param
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://example.com/auth?client_id=1234567890&param=value&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=N4FZ9hdFmYghJ29KnNvSUD17q66yc19%2B
Completed 302 Found in 0ms (GC: 0.0ms)
--------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_CSRF_with_invalid_state
--------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=kzZmlcM%2BnLcM9IA5HYEA8gaPcuUHbBwF
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=invalid" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "invalid"}
Redirected to http://www.example.com/login
Completed 302 Found in 1ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_rejects_proceed_to_paths_if_they_are_relative
-----------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=6GTelWyvSMoQDRZg0uXAdoYV%2B6A3h4ky
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=6GTelWyvSMoQDRZg0uXAdoYV%2B6A3h4ky" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "6GTelWyvSMoQDRZg0uXAdoYV+6A3h4ky"}
Redirect target "login" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=6GTelWyvSMoQDRZg0uXAdoYV%2B6A3h4ky"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
----------------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_temporarily_unavailable
----------------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=UFPFN1dWJjDG6r6HANXmNKEQculATWEA
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=temporarily_unavailable&state=UFPFN1dWJjDG6r6HANXmNKEQculATWEA" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "temporarily_unavailable", "state" => "UFPFN1dWJjDG6r6HANXmNKEQculATWEA"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
---------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_CSRF_without_flash_state
---------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=4tNaIB99AEe4pKKsiHS0XQwfaiF%2B0NUY
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=invalid" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "invalid"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
--------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_CSRF_with_missing_state
--------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=I4Plkgq47kEIJewDKxQtUbjn0f6txxtq
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
--------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_invalid_grant
--------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=YnpknM3JiM5xYcs42ccTD1dtg1B7CgwZ
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=YnpknM3JiM5xYcs42ccTD1dtg1B7CgwZ" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "YnpknM3JiM5xYcs42ccTD1dtg1B7CgwZ"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (GC: 0.0ms)
--------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_unauthorized_client
--------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=M9VKkyOtWtrmcLCCJGdvJC1tMz81%2FRR3
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=M9VKkyOtWtrmcLCCJGdvJC1tMz81%2FRR3" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "M9VKkyOtWtrmcLCCJGdvJC1tMz81/RR3"}
Redirected to http://www.example.com/login
Completed 302 Found in 4ms (GC: 0.0ms)
------------------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_unsupported_response_type
------------------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=z%2F8w2bVnygbt4cPzrR%2F1r4ID%2BHaUjIxk
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=unsupported_response_type&state=z%2F8w2bVnygbt4cPzrR%2F1r4ID%2BHaUjIxk" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "unsupported_response_type", "state" => "z/8w2bVnygbt4cPzrR/1r4ID+HaUjIxk"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects_given_a_triple-slash_net_path
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "///evil.example.org"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=SeYF1iIT6l5plD6yJyZkW%2FXPitUlJrA0
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=SeYF1iIT6l5plD6yJyZkW%2FXPitUlJrA0" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "SeYF1iIT6l5plD6yJyZkW/XPitUlJrA0"}
Redirect target "///evil.example.org" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=SeYF1iIT6l5plD6yJyZkW%2FXPitUlJrA0"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects_given_a_double-slash_net_path
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "//evil.example.org"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=Q%2B6s4XXBojy2O6VSjOh9AVhFK1JsytX%2B
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=Q%2B6s4XXBojy2O6VSjOh9AVhFK1JsytX%2B" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "Q+6s4XXBojy2O6VSjOh9AVhFK1JsytX+"}
Redirect target "//evil.example.org" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=Q%2B6s4XXBojy2O6VSjOh9AVhFK1JsytX%2B"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_unsupported_grant_type
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=UdJ7jl3vwYyG%2FrzADVSc%2Bc6cjqupFRHa
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=UdJ7jl3vwYyG%2FrzADVSc%2Bc6cjqupFRHa" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "UdJ7jl3vwYyG/rzADVSc+c6cjqupFRHa"}
Redirected to http://www.example.com/login
Completed 302 Found in 4ms (GC: 0.0ms)
--------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_invalid_request
--------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=Dv6NneLHfbHfK5i6htVq9xeHbgXNXU5a
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=invalid_request&state=Dv6NneLHfbHfK5i6htVq9xeHbgXNXU5a" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "invalid_request", "state" => "Dv6NneLHfbHfK5i6htVq9xeHbgXNXU5a"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
----------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_neither_code_nor_error
----------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=Co6%2BEkkPkrlECnge9I2%2Fp1GQ8dgxKwPg
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?state=Co6%2BEkkPkrlECnge9I2%2Fp1GQ8dgxKwPg" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"state" => "Co6+EkkPkrlECnge9I2/p1GQ8dgxKwPg"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
---------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code
---------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=pNGjl%2Fs4rCgtgs%2FD3ekGPZNS4vGlLKKD
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=pNGjl%2Fs4rCgtgs%2FD3ekGPZNS4vGlLKKD" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "pNGjl/s4rCgtgs/D3ekGPZNS4vGlLKKD"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (GC: 0.0ms)
------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_invalid_scope
------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=3igJroFG%2FYs4ygTzkfj3%2FMVB9Gux%2BmpP
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=invalid_scope&state=3igJroFG%2FYs4ygTzkfj3%2FMVB9Gux%2BmpP" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "invalid_scope", "state" => "3igJroFG/Ys4ygTzkfj3/MVB9Gux+mpP"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_accepts_proceed_to_paths_if_they_are_absolute
-----------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=hzrb4msKrJYgBKhVrxBrtZGYDulXp1DE
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=hzrb4msKrJYgBKhVrxBrtZGYDulXp1DE" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "hzrb4msKrJYgBKhVrxBrtZGYDulXp1DE"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (GC: 0.0ms)
------------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_unauthorized_client
------------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=6Dv8vD1rLjZwcrEJIL4SEWhMHBp2D6Mz
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=unauthorized_client&state=6Dv8vD1rLjZwcrEJIL4SEWhMHBp2D6Mz" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "unauthorized_client", "state" => "6Dv8vD1rLjZwcrEJIL4SEWhMHBp2D6Mz"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
---------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects_given_a_malformed_URI
---------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com\\n\\r@\\n\\revil.example.org/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=jOzgII4ddNloZ38ouDogKRJ3LC3lEuco
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=jOzgII4ddNloZ38ouDogKRJ3LC3lEuco" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "jOzgII4ddNloZ38ouDogKRJ3LC3lEuco"}
Redirect target "http://www.example.com\\n\\r@\\n\\revil.example.org/login" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=jOzgII4ddNloZ38ouDogKRJ3LC3lEuco"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_no_proceed_to_URL
-----------------------------------------------------------------------
Started GET "/github_sign_in/callback?code=[FILTERED]&state=invalid" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "invalid"}
Redirect target nil does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=invalid"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
---------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_invalid_client
---------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=V9Jvd5Pi%2BqvXAiyGewkchzEGt3hCahlo
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=V9Jvd5Pi%2BqvXAiyGewkchzEGt3hCahlo" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "V9Jvd5Pi+qvXAiyGewkchzEGt3hCahlo"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (GC: 0.0ms)
------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_invalid_authorization_error
------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=NL8uGOO%2BIEfxerbyOKoxSq2Kn%2Bj38si5
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=unknown+error+code&state=NL8uGOO%2BIEfxerbyOKoxSq2Kn%2Bj38si5" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "unknown error code", "state" => "NL8uGOO+IEfxerbyOKoxSq2Kn+j38si5"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_server_error
-----------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=0ocoK2slAb09fbkJljaCUfEOwZAtykt0
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=server_error&state=0ocoK2slAb09fbkJljaCUfEOwZAtykt0" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "server_error", "state" => "0ocoK2slAb09fbkJljaCUfEOwZAtykt0"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_access_denied
------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=pacISiQNiiQEFK7RRoMBwg%2BXTYja2C5q
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=access_denied&state=pacISiQNiiQEFK7RRoMBwg%2BXTYja2C5q" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "access_denied", "state" => "pacISiQNiiQEFK7RRoMBwg+XTYja2C5q"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
----------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_invalid_request
----------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=5jnjGwwMDP148AaIX%2F047Lb9mu3o4XpB
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=5jnjGwwMDP148AaIX%2F047Lb9mu3o4XpB" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "5jnjGwwMDP148AaIX/047Lb9mu3o4XpB"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (GC: 0.0ms)
-----------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects
-----------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://malicious.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=%2BhtAoeaFzfbKtFy6RJjyIAHa0gBoFsdI
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=%2BhtAoeaFzfbKtFy6RJjyIAHa0gBoFsdI" for 127.0.0.1 at 2025-11-05 18:03:28 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "+htAoeaFzfbKtFy6RJjyIAHa0gBoFsdI"}
Redirect target "http://malicious.example.com/login" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=%2BhtAoeaFzfbKtFy6RJjyIAHa0gBoFsdI"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
--------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_empty_URL_target
--------------------------------------------------------------------
--------------------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_with_different_protocol_than_source
--------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_double-slash_path_target
----------------------------------------------------------------------------
----------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_triple-slash_path_target
----------------------------------------------------------------------------
----------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_that_is_blank
----------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_with_different_port_than_source
----------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_that_is_not_a_valid_URL
--------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_allows_URL_target_with_same_origin_as_source
--------------------------------------------------------------------------------------
-----------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_invalid_paths
-----------------------------------------------------------------
---------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_allows_absolute_path_target
---------------------------------------------------------------------
------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_relative_path_target
------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_with_different_host_than_source
----------------------------------------------------------------------------------------------
----------------------------------------------------
GithubSignIn::IdentityTest: test_handling_API_errors
----------------------------------------------------
-------------------------------------------------------
GithubSignIn::IdentityTest: test_handling_missing_email
-------------------------------------------------------
------------------------------------------------------------
GithubSignIn::IdentityTest: test_extracting_user_information
------------------------------------------------------------
--------------------------------------------------------------------------------
GithubSignIn::ButtonHelperTest: test_generating_a_login_button_with_text_content
--------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
GithubSignIn::ButtonHelperTest: test_generating_a_login_button_with_custom_attributes
-------------------------------------------------------------------------------------
--------------------------------------------------------------------------------
GithubSignIn::ButtonHelperTest: test_generating_a_login_button_with_HTML_content
--------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_with_different_host_than_source
----------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_that_is_not_a_valid_URL
--------------------------------------------------------------------------------------
-----------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_invalid_paths
-----------------------------------------------------------------
----------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_triple-slash_path_target
----------------------------------------------------------------------------
---------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_allows_absolute_path_target
---------------------------------------------------------------------
----------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_that_is_blank
----------------------------------------------------------------------------
--------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_empty_URL_target
--------------------------------------------------------------------
--------------------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_with_different_protocol_than_source
--------------------------------------------------------------------------------------------------
------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_relative_path_target
------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_with_different_port_than_source
----------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_allows_URL_target_with_same_origin_as_source
--------------------------------------------------------------------------------------
----------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_double-slash_path_target
----------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------
GithubSignIn::AuthorizationsControllerTest: test_configuring_Github_authorization_URL_including_query_param
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://example.com/auth?client_id=1234567890&param=value&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=UkJWzyWJCd40SKjT3iac%2Fo7aUyaUcVSX
Completed 302 Found in 2ms (GC: 0.0ms)
----------------------------------------------------------------------------------------
GithubSignIn::AuthorizationsControllerTest: test_redirecting_to_Github_for_authorization
----------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=B2Tt1hqLLMDUAZJ1QLRKohcNgB7OCXya
Completed 302 Found in 0ms (GC: 0.0ms)
-------------------------------------------------------
GithubSignIn::IdentityTest: test_handling_missing_email
-------------------------------------------------------
----------------------------------------------------
GithubSignIn::IdentityTest: test_handling_API_errors
----------------------------------------------------
------------------------------------------------------------
GithubSignIn::IdentityTest: test_extracting_user_information
------------------------------------------------------------
--------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_invalid_grant
--------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=b2XENOBlA5EJAMsAou2IqZGRl8A2xoGR
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=b2XENOBlA5EJAMsAou2IqZGRl8A2xoGR" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "b2XENOBlA5EJAMsAou2IqZGRl8A2xoGR"}
Redirected to http://www.example.com/login
Completed 302 Found in 6ms (GC: 0.2ms)
--------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_CSRF_with_invalid_state
--------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=uw4OHHilns1hCO%2FB7pC378tlXpH7j1gw
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=invalid" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "invalid"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects
-----------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://malicious.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=vZCemndumL%2B4Ii4Eqk7Xv6ADUBanYu5q
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=vZCemndumL%2B4Ii4Eqk7Xv6ADUBanYu5q" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "vZCemndumL+4Ii4Eqk7Xv6ADUBanYu5q"}
Redirect target "http://malicious.example.com/login" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=vZCemndumL%2B4Ii4Eqk7Xv6ADUBanYu5q"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_invalid_authorization_error
------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=rLKnStpkk6LWBOsLwjUInTh%2BaHCjHda5
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=unknown+error+code&state=rLKnStpkk6LWBOsLwjUInTh%2BaHCjHda5" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "unknown error code", "state" => "rLKnStpkk6LWBOsLwjUInTh+aHCjHda5"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
---------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_invalid_client
---------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=z%2FeKWK0YM9DgZxiFZpeB%2FF1Jq2N9wIk3
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=z%2FeKWK0YM9DgZxiFZpeB%2FF1Jq2N9wIk3" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "z/eKWK0YM9DgZxiFZpeB/F1Jq2N9wIk3"}
Redirected to http://www.example.com/login
Completed 302 Found in 4ms (GC: 0.0ms)
---------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code
---------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=aWXOygPOl7gXOD6MwbbHJBibhGjmWuur
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=aWXOygPOl7gXOD6MwbbHJBibhGjmWuur" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "aWXOygPOl7gXOD6MwbbHJBibhGjmWuur"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (GC: 0.0ms)
---------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects_given_a_malformed_URI
---------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com\\n\\r@\\n\\revil.example.org/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=xDNTWfN%2FAwfPjE1v7yQ9y3wqHiAFiKZZ
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=xDNTWfN%2FAwfPjE1v7yQ9y3wqHiAFiKZZ" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "xDNTWfN/AwfPjE1v7yQ9y3wqHiAFiKZZ"}
Redirect target "http://www.example.com\\n\\r@\\n\\revil.example.org/login" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=xDNTWfN%2FAwfPjE1v7yQ9y3wqHiAFiKZZ"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
----------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_neither_code_nor_error
----------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=Om7EVozpUDeqvh5ak1gnPVjC6w%2BqcFGv
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?state=Om7EVozpUDeqvh5ak1gnPVjC6w%2BqcFGv" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"state" => "Om7EVozpUDeqvh5ak1gnPVjC6w+qcFGv"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_unsupported_grant_type
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=95jmzrvq56RkVjKINTJO6VeAWJyskkLz
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=95jmzrvq56RkVjKINTJO6VeAWJyskkLz" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "95jmzrvq56RkVjKINTJO6VeAWJyskkLz"}
Redirected to http://www.example.com/login
Completed 302 Found in 4ms (GC: 0.0ms)
--------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_CSRF_with_missing_state
--------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=sAJAE7%2BFfleFDBVRfXmJg5ihsdQHvMSM
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
------------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_unauthorized_client
------------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=5yKSJglMfQMNNbWmi231adE1dSEOCYRY
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=unauthorized_client&state=5yKSJglMfQMNNbWmi231adE1dSEOCYRY" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "unauthorized_client", "state" => "5yKSJglMfQMNNbWmi231adE1dSEOCYRY"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
---------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_CSRF_without_flash_state
---------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=Wuj8NkLHZcEBA5%2BW7K6OT7pGzO4VQwha
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=invalid" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "invalid"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
--------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_unauthorized_client
--------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=WABAT5wqyyoOO8KgG5AkSqgflzNLsj9b
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=WABAT5wqyyoOO8KgG5AkSqgflzNLsj9b" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "WABAT5wqyyoOO8KgG5AkSqgflzNLsj9b"}
Redirected to http://www.example.com/login
Completed 302 Found in 4ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_server_error
-----------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=PiBluGWjZQb2SjiacwHyaj2hsgfj0zR0
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=server_error&state=PiBluGWjZQb2SjiacwHyaj2hsgfj0zR0" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "server_error", "state" => "PiBluGWjZQb2SjiacwHyaj2hsgfj0zR0"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
--------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_invalid_request
--------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=Y8HdIrEvvRdBV8ebz8qQ034OUZDdePBu
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=invalid_request&state=Y8HdIrEvvRdBV8ebz8qQ034OUZDdePBu" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "invalid_request", "state" => "Y8HdIrEvvRdBV8ebz8qQ034OUZDdePBu"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
----------------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_temporarily_unavailable
----------------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=dGnpGCFO%2FAwy0MY%2FGKpkRtl8dCrCchep
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=temporarily_unavailable&state=dGnpGCFO%2FAwy0MY%2FGKpkRtl8dCrCchep" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "temporarily_unavailable", "state" => "dGnpGCFO/Awy0MY/GKpkRtl8dCrCchep"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
------------------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_unsupported_response_type
------------------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=ZZk6ZGT4Ap3Gf15z%2F0QxVGAw2uLiEy%2F3
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=unsupported_response_type&state=ZZk6ZGT4Ap3Gf15z%2F0QxVGAw2uLiEy%2F3" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "unsupported_response_type", "state" => "ZZk6ZGT4Ap3Gf15z/0QxVGAw2uLiEy/3"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects_given_a_triple-slash_net_path
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "///evil.example.org"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=4kUfEAAE72%2FLfR4%2FisbZeo28un4FOfIj
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=4kUfEAAE72%2FLfR4%2FisbZeo28un4FOfIj" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "4kUfEAAE72/LfR4/isbZeo28un4FOfIj"}
Redirect target "///evil.example.org" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=4kUfEAAE72%2FLfR4%2FisbZeo28un4FOfIj"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
----------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_invalid_request
----------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=x%2Bd5FHx0pg3bMMYzcDpBmasgJbMYZ3Zp
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=x%2Bd5FHx0pg3bMMYzcDpBmasgJbMYZ3Zp" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "x+d5FHx0pg3bMMYzcDpBmasgJbMYZ3Zp"}
Redirected to http://www.example.com/login
Completed 302 Found in 4ms (GC: 0.0ms)
------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_invalid_scope
------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=%2BPREn612QBGAuMAYUGuO80xOCV3CC60C
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=invalid_scope&state=%2BPREn612QBGAuMAYUGuO80xOCV3CC60C" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "invalid_scope", "state" => "+PREn612QBGAuMAYUGuO80xOCV3CC60C"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_access_denied
------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=VLUq3cO1nU4NMt5CP2QIxLlVVOyDV3pI
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=access_denied&state=VLUq3cO1nU4NMt5CP2QIxLlVVOyDV3pI" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "access_denied", "state" => "VLUq3cO1nU4NMt5CP2QIxLlVVOyDV3pI"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_rejects_proceed_to_paths_if_they_are_relative
-----------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=6XWZuobHsgST5d%2Fl%2BVu2K%2BhKsq5Ng3e4
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=6XWZuobHsgST5d%2Fl%2BVu2K%2BhKsq5Ng3e4" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "6XWZuobHsgST5d/l+Vu2K+hKsq5Ng3e4"}
Redirect target "login" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=6XWZuobHsgST5d%2Fl%2BVu2K%2BhKsq5Ng3e4"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects_given_a_double-slash_net_path
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "//evil.example.org"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=f2DmRlBgUdvpnqMKFWz3IQtoc6vHTBYA
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=f2DmRlBgUdvpnqMKFWz3IQtoc6vHTBYA" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "f2DmRlBgUdvpnqMKFWz3IQtoc6vHTBYA"}
Redirect target "//evil.example.org" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=f2DmRlBgUdvpnqMKFWz3IQtoc6vHTBYA"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_accepts_proceed_to_paths_if_they_are_absolute
-----------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=OTgG4HVNHAqEXQ4984BJAk1%2BfR1cwRKQ
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=OTgG4HVNHAqEXQ4984BJAk1%2BfR1cwRKQ" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "OTgG4HVNHAqEXQ4984BJAk1+fR1cwRKQ"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (GC: 0.0ms)
-----------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_no_proceed_to_URL
-----------------------------------------------------------------------
Started GET "/github_sign_in/callback?code=[FILTERED]&state=invalid" for 127.0.0.1 at 2025-11-05 18:03:59 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "invalid"}
Redirect target nil does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=invalid"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
------------------------------------------------------------
GithubSignIn::IdentityTest: test_extracting_user_information
------------------------------------------------------------
-------------------------------------------------------
GithubSignIn::IdentityTest: test_handling_missing_email
-------------------------------------------------------
----------------------------------------------------
GithubSignIn::IdentityTest: test_handling_API_errors
----------------------------------------------------
--------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_that_is_not_a_valid_URL
--------------------------------------------------------------------------------------
---------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_allows_absolute_path_target
---------------------------------------------------------------------
------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_relative_path_target
------------------------------------------------------------------------
----------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_triple-slash_path_target
----------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_with_different_host_than_source
----------------------------------------------------------------------------------------------
--------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_empty_URL_target
--------------------------------------------------------------------
----------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_that_is_blank
----------------------------------------------------------------------------
----------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_double-slash_path_target
----------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_with_different_protocol_than_source
--------------------------------------------------------------------------------------------------
-----------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_invalid_paths
-----------------------------------------------------------------
--------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_allows_URL_target_with_same_origin_as_source
--------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_with_different_port_than_source
----------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------
GithubSignIn::ButtonHelperTest: test_generating_a_login_button_with_HTML_content
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
GithubSignIn::ButtonHelperTest: test_generating_a_login_button_with_text_content
--------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
GithubSignIn::ButtonHelperTest: test_generating_a_login_button_with_custom_attributes
-------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_invalid_scope
------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=WrwH4e2%2B9nKHhjnYbOti4K3VfRQwppr0
Completed 302 Found in 2ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=invalid_scope&state=WrwH4e2%2B9nKHhjnYbOti4K3VfRQwppr0" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "invalid_scope", "state" => "WrwH4e2+9nKHhjnYbOti4K3VfRQwppr0"}
Redirected to http://www.example.com/login
Completed 302 Found in 1ms (GC: 0.0ms)
---------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_invalid_client
---------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=D0tIE2HSt9FgC4ZvqmHrJX5sudpj%2BsJp
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=D0tIE2HSt9FgC4ZvqmHrJX5sudpj%2BsJp" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "D0tIE2HSt9FgC4ZvqmHrJX5sudpj+sJp"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (GC: 0.0ms)
-----------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects
-----------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://malicious.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=77ollL%2FsQVkfimdBYPkCQsJlm%2BYDmKFv
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=77ollL%2FsQVkfimdBYPkCQsJlm%2BYDmKFv" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "77ollL/sQVkfimdBYPkCQsJlm+YDmKFv"}
Redirect target "http://malicious.example.com/login" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=77ollL%2FsQVkfimdBYPkCQsJlm%2BYDmKFv"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_server_error
-----------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=8AbiAhGjqyg%2FDUedK%2F31m4%2BX%2FSw4N3LG
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=server_error&state=8AbiAhGjqyg%2FDUedK%2F31m4%2BX%2FSw4N3LG" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "server_error", "state" => "8AbiAhGjqyg/DUedK/31m4+X/Sw4N3LG"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
---------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_CSRF_without_flash_state
---------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=hLLlMwg2QZV7IuVOOgsRR%2BaFrklbF7ex
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=invalid" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "invalid"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
------------------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_unsupported_response_type
------------------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=NM4NPEQzUHRVr06zUk%2BJCqs0O7K74RKr
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=unsupported_response_type&state=NM4NPEQzUHRVr06zUk%2BJCqs0O7K74RKr" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "unsupported_response_type", "state" => "NM4NPEQzUHRVr06zUk+JCqs0O7K74RKr"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
---------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code
---------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=5LQjZEPGnPD%2FUxRUDoKTvCnF8wuLjtKN
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=5LQjZEPGnPD%2FUxRUDoKTvCnF8wuLjtKN" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "5LQjZEPGnPD/UxRUDoKTvCnF8wuLjtKN"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (GC: 0.0ms)
----------------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_temporarily_unavailable
----------------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=QtqHiW2BwHETBlBUYdLmJhkTCC6vY8jX
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=temporarily_unavailable&state=QtqHiW2BwHETBlBUYdLmJhkTCC6vY8jX" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "temporarily_unavailable", "state" => "QtqHiW2BwHETBlBUYdLmJhkTCC6vY8jX"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
--------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_CSRF_with_invalid_state
--------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=SpjPlfPSTC7kM6jkRZmTZ5wT7X3te8Le
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=invalid" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "invalid"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
------------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_unauthorized_client
------------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=qMWNgKDSbgGf2JnZJJRDhuRQPY2kMsDJ
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=unauthorized_client&state=qMWNgKDSbgGf2JnZJJRDhuRQPY2kMsDJ" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "unauthorized_client", "state" => "qMWNgKDSbgGf2JnZJJRDhuRQPY2kMsDJ"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects_given_a_double-slash_net_path
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "//evil.example.org"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=VWxC2nu4dY2javyBh3nGNM0eHwyxhzYY
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=VWxC2nu4dY2javyBh3nGNM0eHwyxhzYY" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "VWxC2nu4dY2javyBh3nGNM0eHwyxhzYY"}
Redirect target "//evil.example.org" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=VWxC2nu4dY2javyBh3nGNM0eHwyxhzYY"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_rejects_proceed_to_paths_if_they_are_relative
-----------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=lCRIIXCpHQmPHaHa17tGow8I3Q4dwbKp
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=lCRIIXCpHQmPHaHa17tGow8I3Q4dwbKp" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "lCRIIXCpHQmPHaHa17tGow8I3Q4dwbKp"}
Redirect target "login" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=lCRIIXCpHQmPHaHa17tGow8I3Q4dwbKp"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_unsupported_grant_type
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=RAM%2BneGsbYioLpRCQeiw%2BsQ74ptx4ENn
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=RAM%2BneGsbYioLpRCQeiw%2BsQ74ptx4ENn" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "RAM+neGsbYioLpRCQeiw+sQ74ptx4ENn"}
Redirected to http://www.example.com/login
Completed 302 Found in 4ms (GC: 0.0ms)
------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_access_denied
------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=6KbhGHBqVZ9W8QZeWFEPnYcobS6BQWW%2B
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=access_denied&state=6KbhGHBqVZ9W8QZeWFEPnYcobS6BQWW%2B" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "access_denied", "state" => "6KbhGHBqVZ9W8QZeWFEPnYcobS6BQWW+"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
--------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_CSRF_with_missing_state
--------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=sEfHA3r4rNa0o9mPPDp9Uyewi0w9WT3w
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects_given_a_triple-slash_net_path
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "///evil.example.org"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=vz5Pi16jVDml3pg9GNcZSn3uvkX3uHTx
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=vz5Pi16jVDml3pg9GNcZSn3uvkX3uHTx" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "vz5Pi16jVDml3pg9GNcZSn3uvkX3uHTx"}
Redirect target "///evil.example.org" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=vz5Pi16jVDml3pg9GNcZSn3uvkX3uHTx"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
---------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects_given_a_malformed_URI
---------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com\\n\\r@\\n\\revil.example.org/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=ZSFaS7We0MU0SpX76LXVYwzdimoiwYn%2B
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=ZSFaS7We0MU0SpX76LXVYwzdimoiwYn%2B" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "ZSFaS7We0MU0SpX76LXVYwzdimoiwYn+"}
Redirect target "http://www.example.com\\n\\r@\\n\\revil.example.org/login" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=ZSFaS7We0MU0SpX76LXVYwzdimoiwYn%2B"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
----------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_neither_code_nor_error
----------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=7u3380wGM%2BoxSDDo4vbiMBT%2BNq4Mgy65
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?state=7u3380wGM%2BoxSDDo4vbiMBT%2BNq4Mgy65" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"state" => "7u3380wGM+oxSDDo4vbiMBT+Nq4Mgy65"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_no_proceed_to_URL
-----------------------------------------------------------------------
Started GET "/github_sign_in/callback?code=[FILTERED]&state=invalid" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "invalid"}
Redirect target nil does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=invalid"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
--------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_invalid_grant
--------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=ZNcI1rt%2FEXIuBh6a2wdxfn%2FWSAsBvYki
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=ZNcI1rt%2FEXIuBh6a2wdxfn%2FWSAsBvYki" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "ZNcI1rt/EXIuBh6a2wdxfn/WSAsBvYki"}
Redirected to http://www.example.com/login
Completed 302 Found in 4ms (GC: 0.0ms)
----------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_invalid_request
----------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=4peMJsM38Hr4PNpA5lw8ECw4wCS%2Bhy%2Bq
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=4peMJsM38Hr4PNpA5lw8ECw4wCS%2Bhy%2Bq" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "4peMJsM38Hr4PNpA5lw8ECw4wCS+hy+q"}
Redirected to http://www.example.com/login
Completed 302 Found in 4ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_accepts_proceed_to_paths_if_they_are_absolute
-----------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=3RZZfmDAfH2ae31rr2pb8AQAiHC%2FTHoE
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=3RZZfmDAfH2ae31rr2pb8AQAiHC%2FTHoE" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "3RZZfmDAfH2ae31rr2pb8AQAiHC/THoE"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (GC: 0.0ms)
--------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_invalid_request
--------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=cH762BE9bE4KoGmGuN%2BaQjZDVcBjEtWA
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=invalid_request&state=cH762BE9bE4KoGmGuN%2BaQjZDVcBjEtWA" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "invalid_request", "state" => "cH762BE9bE4KoGmGuN+aQjZDVcBjEtWA"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
--------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_unauthorized_client
--------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=dtTCH3delhSii1Tt2s3i%2B2HS3EPlaZkX
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=dtTCH3delhSii1Tt2s3i%2B2HS3EPlaZkX" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "dtTCH3delhSii1Tt2s3i+2HS3EPlaZkX"}
Redirected to http://www.example.com/login
Completed 302 Found in 4ms (GC: 0.0ms)
------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_invalid_authorization_error
------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=Y2w0%2FgrQwBlHFVk1uwymEURNg5QxUAQt
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=unknown+error+code&state=Y2w0%2FgrQwBlHFVk1uwymEURNg5QxUAQt" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "unknown error code", "state" => "Y2w0/grQwBlHFVk1uwymEURNg5QxUAQt"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------------
GithubSignIn::AuthorizationsControllerTest: test_configuring_Github_authorization_URL_including_query_param
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://example.com/auth?client_id=1234567890&param=value&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=tQ3G1AAcjH6J3WkCaNE%2FlKWQGVsowyp2
Completed 302 Found in 0ms (GC: 0.0ms)
----------------------------------------------------------------------------------------
GithubSignIn::AuthorizationsControllerTest: test_redirecting_to_Github_for_authorization
----------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:01 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=QmpvDGzq558IF11JFG4jof1agM%2Blz%2BTV
Completed 302 Found in 0ms (GC: 0.0ms)
--------------------------------------------------------------------------------
GithubSignIn::ButtonHelperTest: test_generating_a_login_button_with_HTML_content
--------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
GithubSignIn::ButtonHelperTest: test_generating_a_login_button_with_custom_attributes
-------------------------------------------------------------------------------------
--------------------------------------------------------------------------------
GithubSignIn::ButtonHelperTest: test_generating_a_login_button_with_text_content
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_unauthorized_client
--------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=NXTygq5vkTqB40vYqAYR4dTYL2PErjVk
Completed 302 Found in 2ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=NXTygq5vkTqB40vYqAYR4dTYL2PErjVk" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "NXTygq5vkTqB40vYqAYR4dTYL2PErjVk"}
Redirected to http://www.example.com/login
Completed 302 Found in 6ms (GC: 0.0ms)
--------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_CSRF_with_missing_state
--------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=8CqYXnVEkQqyuq2iSiKisPt3%2FOa0GWEp
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_invalid_scope
------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=%2Bsu4RgrM1733JBYvRsBBTQprgIkhPCs%2B
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=invalid_scope&state=%2Bsu4RgrM1733JBYvRsBBTQprgIkhPCs%2B" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "invalid_scope", "state" => "+su4RgrM1733JBYvRsBBTQprgIkhPCs+"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
------------------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_unsupported_response_type
------------------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=JlWcmw%2Btyv7URla2JPDZEbY6guhxM2Sr
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=unsupported_response_type&state=JlWcmw%2Btyv7URla2JPDZEbY6guhxM2Sr" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "unsupported_response_type", "state" => "JlWcmw+tyv7URla2JPDZEbY6guhxM2Sr"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
----------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_invalid_request
----------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=tHbyprUF72LAcIRNOT%2FzjHTVDPBXh1nC
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=tHbyprUF72LAcIRNOT%2FzjHTVDPBXh1nC" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "tHbyprUF72LAcIRNOT/zjHTVDPBXh1nC"}
Redirected to http://www.example.com/login
Completed 302 Found in 4ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_rejects_proceed_to_paths_if_they_are_relative
-----------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=V%2FwVRorO3d9uL%2FRldb55%2BH2zynnze%2BAT
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=V%2FwVRorO3d9uL%2FRldb55%2BH2zynnze%2BAT" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "V/wVRorO3d9uL/Rldb55+H2zynnze+AT"}
Redirect target "login" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=V%2FwVRorO3d9uL%2FRldb55%2BH2zynnze%2BAT"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
--------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_CSRF_with_invalid_state
--------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=ApSXnpGVM5TJvElkAeJY2hwRrdvciY%2Bq
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=invalid" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "invalid"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
----------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_neither_code_nor_error
----------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=zQy%2FrT4cyMUpHKMKbmyO3lzezUSt2eMC
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?state=zQy%2FrT4cyMUpHKMKbmyO3lzezUSt2eMC" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"state" => "zQy/rT4cyMUpHKMKbmyO3lzezUSt2eMC"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects
-----------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://malicious.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=KL641195ipHQlFe9eRV6vnVhiY6G6lim
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=KL641195ipHQlFe9eRV6vnVhiY6G6lim" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "KL641195ipHQlFe9eRV6vnVhiY6G6lim"}
Redirect target "http://malicious.example.com/login" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=KL641195ipHQlFe9eRV6vnVhiY6G6lim"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_invalid_authorization_error
------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=4xT2agpq09LaHNBsKYHBt9LloiOyW2Bx
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=unknown+error+code&state=4xT2agpq09LaHNBsKYHBt9LloiOyW2Bx" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "unknown error code", "state" => "4xT2agpq09LaHNBsKYHBt9LloiOyW2Bx"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_no_proceed_to_URL
-----------------------------------------------------------------------
Started GET "/github_sign_in/callback?code=[FILTERED]&state=invalid" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "invalid"}
Redirect target nil does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=invalid"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects_given_a_triple-slash_net_path
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "///evil.example.org"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=T%2FQLsgoqd6EemYA6ODqsG0HLUFdBW8mP
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=T%2FQLsgoqd6EemYA6ODqsG0HLUFdBW8mP" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "T/QLsgoqd6EemYA6ODqsG0HLUFdBW8mP"}
Redirect target "///evil.example.org" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=T%2FQLsgoqd6EemYA6ODqsG0HLUFdBW8mP"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
----------------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_temporarily_unavailable
----------------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=nQS1QkKyvWlOSH%2BRfQtQOxOggYLoKg1Y
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=temporarily_unavailable&state=nQS1QkKyvWlOSH%2BRfQtQOxOggYLoKg1Y" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "temporarily_unavailable", "state" => "nQS1QkKyvWlOSH+RfQtQOxOggYLoKg1Y"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
--------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_invalid_request
--------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=2H1rec2bOreLJexqlIHnmh1oYBqItAsh
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=invalid_request&state=2H1rec2bOreLJexqlIHnmh1oYBqItAsh" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "invalid_request", "state" => "2H1rec2bOreLJexqlIHnmh1oYBqItAsh"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_unsupported_grant_type
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=rPF4EH1cxcqqPWjSRF7eqO7Zy%2Fn%2F%2Bzw8
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=rPF4EH1cxcqqPWjSRF7eqO7Zy%2Fn%2F%2Bzw8" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "rPF4EH1cxcqqPWjSRF7eqO7Zy/n/+zw8"}
Redirected to http://www.example.com/login
Completed 302 Found in 4ms (GC: 0.0ms)
---------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_invalid_client
---------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=kvmnFk2wdLpP9fornvvOZtVcl6nxsrww
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=kvmnFk2wdLpP9fornvvOZtVcl6nxsrww" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "kvmnFk2wdLpP9fornvvOZtVcl6nxsrww"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (GC: 0.0ms)
---------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code
---------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=InToCKB0%2FxuFFcmjG9D0oCTktFQLqp0g
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=InToCKB0%2FxuFFcmjG9D0oCTktFQLqp0g" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "InToCKB0/xuFFcmjG9D0oCTktFQLqp0g"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_server_error
-----------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=V4KqwfMAxRsc%2F8YmiDvmRbZE3YdMyUbA
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=server_error&state=V4KqwfMAxRsc%2F8YmiDvmRbZE3YdMyUbA" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "server_error", "state" => "V4KqwfMAxRsc/8YmiDvmRbZE3YdMyUbA"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
--------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_invalid_grant
--------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=hUcCZjEz23FcmPu3IYDlhkE9kYzLTkyc
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=hUcCZjEz23FcmPu3IYDlhkE9kYzLTkyc" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "hUcCZjEz23FcmPu3IYDlhkE9kYzLTkyc"}
Redirected to http://www.example.com/login
Completed 302 Found in 4ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects_given_a_double-slash_net_path
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "//evil.example.org"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=bkcvytmbn13pJAA9gotlPHlOyDCJ3N7A
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=bkcvytmbn13pJAA9gotlPHlOyDCJ3N7A" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "bkcvytmbn13pJAA9gotlPHlOyDCJ3N7A"}
Redirect target "//evil.example.org" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=bkcvytmbn13pJAA9gotlPHlOyDCJ3N7A"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_access_denied
------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=qeL%2FxjoVsZxDExokmZE9VDLrQR9SuSEb
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=access_denied&state=qeL%2FxjoVsZxDExokmZE9VDLrQR9SuSEb" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "access_denied", "state" => "qeL/xjoVsZxDExokmZE9VDLrQR9SuSEb"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_accepts_proceed_to_paths_if_they_are_absolute
-----------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=nEowuH0B4KGyVpvC1A8eiG2nRqH%2FXIhA
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=nEowuH0B4KGyVpvC1A8eiG2nRqH%2FXIhA" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "nEowuH0B4KGyVpvC1A8eiG2nRqH/XIhA"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (GC: 0.0ms)
---------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects_given_a_malformed_URI
---------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com\\n\\r@\\n\\revil.example.org/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=zXUurmRvFCa0wgCW61%2BwNxvYuFGFPoE4
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=zXUurmRvFCa0wgCW61%2BwNxvYuFGFPoE4" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "zXUurmRvFCa0wgCW61+wNxvYuFGFPoE4"}
Redirect target "http://www.example.com\\n\\r@\\n\\revil.example.org/login" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=zXUurmRvFCa0wgCW61%2BwNxvYuFGFPoE4"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
---------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_CSRF_without_flash_state
---------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=FPDh07jQJHcXYeCad%2BF6qLgWp8OlBnB0
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=invalid" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "invalid"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
------------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_unauthorized_client
------------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=FTnZC5vnoYAoNzi89FlImnEcgzmFCynM
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=unauthorized_client&state=FTnZC5vnoYAoNzi89FlImnEcgzmFCynM" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "unauthorized_client", "state" => "FTnZC5vnoYAoNzi89FlImnEcgzmFCynM"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
----------------------------------------------------------------------------------------
GithubSignIn::AuthorizationsControllerTest: test_redirecting_to_Github_for_authorization
----------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=fLjp6B%2BaoqSw14ogVDNpn1qOFyY85VOO
Completed 302 Found in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------------
GithubSignIn::AuthorizationsControllerTest: test_configuring_Github_authorization_URL_including_query_param
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:03 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://example.com/auth?client_id=1234567890&param=value&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=KgiUPoZfFDFfBg5QVlMjLJtsl%2BfoUo6V
Completed 302 Found in 0ms (GC: 0.0ms)
------------------------------------------------------------
GithubSignIn::IdentityTest: test_extracting_user_information
------------------------------------------------------------
----------------------------------------------------
GithubSignIn::IdentityTest: test_handling_API_errors
----------------------------------------------------
-------------------------------------------------------
GithubSignIn::IdentityTest: test_handling_missing_email
-------------------------------------------------------
----------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_that_is_blank
----------------------------------------------------------------------------
-----------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_invalid_paths
-----------------------------------------------------------------
----------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_double-slash_path_target
----------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_with_different_host_than_source
----------------------------------------------------------------------------------------------
---------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_allows_absolute_path_target
---------------------------------------------------------------------
----------------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_with_different_port_than_source
----------------------------------------------------------------------------------------------
--------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_empty_URL_target
--------------------------------------------------------------------
--------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_allows_URL_target_with_same_origin_as_source
--------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_with_different_protocol_than_source
--------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_triple-slash_path_target
----------------------------------------------------------------------------
--------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_that_is_not_a_valid_URL
--------------------------------------------------------------------------------------
------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_relative_path_target
------------------------------------------------------------------------
--------------------------------------------------------------------------------
GithubSignIn::ButtonHelperTest: test_generating_a_login_button_with_HTML_content
--------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
GithubSignIn::ButtonHelperTest: test_generating_a_login_button_with_custom_attributes
-------------------------------------------------------------------------------------
--------------------------------------------------------------------------------
GithubSignIn::ButtonHelperTest: test_generating_a_login_button_with_text_content
--------------------------------------------------------------------------------
-----------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_invalid_paths
-----------------------------------------------------------------
----------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_triple-slash_path_target
----------------------------------------------------------------------------
--------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_empty_URL_target
--------------------------------------------------------------------
------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_relative_path_target
------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_with_different_host_than_source
----------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_allows_URL_target_with_same_origin_as_source
--------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_that_is_not_a_valid_URL
--------------------------------------------------------------------------------------
---------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_allows_absolute_path_target
---------------------------------------------------------------------
--------------------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_with_different_protocol_than_source
--------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_double-slash_path_target
----------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_with_different_port_than_source
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_that_is_blank
----------------------------------------------------------------------------
------------------------------------------------------------
GithubSignIn::IdentityTest: test_extracting_user_information
------------------------------------------------------------
----------------------------------------------------
GithubSignIn::IdentityTest: test_handling_API_errors
----------------------------------------------------
-------------------------------------------------------
GithubSignIn::IdentityTest: test_handling_missing_email
-------------------------------------------------------
----------------------------------------------------------------------------------------
GithubSignIn::AuthorizationsControllerTest: test_redirecting_to_Github_for_authorization
----------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=0XkoYODrPrw8L6zhQPULQ2PPmH9J5pGv
Completed 302 Found in 2ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------------
GithubSignIn::AuthorizationsControllerTest: test_configuring_Github_authorization_URL_including_query_param
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://example.com/auth?client_id=1234567890&param=value&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=RVcgUwZCHnMIGed9QV8iTdj0%2FT%2Bvy1Gr
Completed 302 Found in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_accepts_proceed_to_paths_if_they_are_absolute
-----------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=QeQGMxxg7ke8bI2C1RHolEX4204e%2FKHv
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=QeQGMxxg7ke8bI2C1RHolEX4204e%2FKHv" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "QeQGMxxg7ke8bI2C1RHolEX4204e/KHv"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (GC: 0.0ms)
----------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_invalid_request
----------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=LhcPrULBvDkOqt32d2BSqWYOnEZXd4Gz
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=LhcPrULBvDkOqt32d2BSqWYOnEZXd4Gz" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "LhcPrULBvDkOqt32d2BSqWYOnEZXd4Gz"}
Redirected to http://www.example.com/login
Completed 302 Found in 4ms (GC: 0.0ms)
----------------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_temporarily_unavailable
----------------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=dV40uRf8hjNUBTRf3E6lGTayy7TBBVns
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=temporarily_unavailable&state=dV40uRf8hjNUBTRf3E6lGTayy7TBBVns" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "temporarily_unavailable", "state" => "dV40uRf8hjNUBTRf3E6lGTayy7TBBVns"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_no_proceed_to_URL
-----------------------------------------------------------------------
Started GET "/github_sign_in/callback?code=[FILTERED]&state=invalid" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "invalid"}
Redirect target nil does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=invalid"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_invalid_authorization_error
------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=nmVJ%2BJPGPgX5D0QXlXRZdZgMjJMah%2Fy9
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=unknown+error+code&state=nmVJ%2BJPGPgX5D0QXlXRZdZgMjJMah%2Fy9" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "unknown error code", "state" => "nmVJ+JPGPgX5D0QXlXRZdZgMjJMah/y9"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
---------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_CSRF_without_flash_state
---------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=jmAvRJchtHqxTBaP%2Fu34vFnfM5SbZ7o7
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=invalid" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "invalid"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_unsupported_grant_type
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=qSSS8jfimYyTwGvOFSNoCCRA0nXmUWcC
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=qSSS8jfimYyTwGvOFSNoCCRA0nXmUWcC" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "qSSS8jfimYyTwGvOFSNoCCRA0nXmUWcC"}
Redirected to http://www.example.com/login
Completed 302 Found in 4ms (GC: 0.0ms)
---------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code
---------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=Vu7ydvuX%2FlrZ9U3AL1zflHMHhZe%2FFiZO
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=Vu7ydvuX%2FlrZ9U3AL1zflHMHhZe%2FFiZO" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "Vu7ydvuX/lrZ9U3AL1zflHMHhZe/FiZO"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (GC: 0.0ms)
--------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_unauthorized_client
--------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=0d6eHQA5UVs7Vq5Cb4HmHpq4KVL1Xo8i
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=0d6eHQA5UVs7Vq5Cb4HmHpq4KVL1Xo8i" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "0d6eHQA5UVs7Vq5Cb4HmHpq4KVL1Xo8i"}
Redirected to http://www.example.com/login
Completed 302 Found in 4ms (GC: 0.0ms)
------------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_unauthorized_client
------------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=3LOE8eovB5jKCZiauMJoS5D%2F%2FmugoODi
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=unauthorized_client&state=3LOE8eovB5jKCZiauMJoS5D%2F%2FmugoODi" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "unauthorized_client", "state" => "3LOE8eovB5jKCZiauMJoS5D//mugoODi"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
--------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_CSRF_with_invalid_state
--------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=xMe7Cq%2B54zk3Q2kb61uV%2BVbuI9mm5oQO
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=invalid" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "invalid"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects
-----------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://malicious.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=nDxc2vyMPiArAN9W9%2BaqR0A31hzRVZcu
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=nDxc2vyMPiArAN9W9%2BaqR0A31hzRVZcu" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "nDxc2vyMPiArAN9W9+aqR0A31hzRVZcu"}
Redirect target "http://malicious.example.com/login" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=nDxc2vyMPiArAN9W9%2BaqR0A31hzRVZcu"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
------------------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_unsupported_response_type
------------------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=fzuvP4ew46BVbO8JuWxSXt7BIGCGWXaA
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=unsupported_response_type&state=fzuvP4ew46BVbO8JuWxSXt7BIGCGWXaA" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "unsupported_response_type", "state" => "fzuvP4ew46BVbO8JuWxSXt7BIGCGWXaA"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects_given_a_triple-slash_net_path
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "///evil.example.org"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=kxCTI6rpp3loVGe2oz7feFTvHkqSDye4
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=kxCTI6rpp3loVGe2oz7feFTvHkqSDye4" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "kxCTI6rpp3loVGe2oz7feFTvHkqSDye4"}
Redirect target "///evil.example.org" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=kxCTI6rpp3loVGe2oz7feFTvHkqSDye4"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
--------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_invalid_request
--------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=55yVgaIl6HbRUeGIeNFaV1hIyXIagxTm
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=invalid_request&state=55yVgaIl6HbRUeGIeNFaV1hIyXIagxTm" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "invalid_request", "state" => "55yVgaIl6HbRUeGIeNFaV1hIyXIagxTm"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
--------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_invalid_grant
--------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=afraBxVdadpstwOfRMNK3fhtkfv7mWX4
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=afraBxVdadpstwOfRMNK3fhtkfv7mWX4" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "afraBxVdadpstwOfRMNK3fhtkfv7mWX4"}
Redirected to http://www.example.com/login
Completed 302 Found in 4ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_rejects_proceed_to_paths_if_they_are_relative
-----------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=vKZ0ycH%2F4naryMAJLVqnZoxWHxCWjnwX
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=vKZ0ycH%2F4naryMAJLVqnZoxWHxCWjnwX" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "vKZ0ycH/4naryMAJLVqnZoxWHxCWjnwX"}
Redirect target "login" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=vKZ0ycH%2F4naryMAJLVqnZoxWHxCWjnwX"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_access_denied
------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=zPUMFIjHjXwB6UIy7C9OGQHTRbxsDwqu
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=access_denied&state=zPUMFIjHjXwB6UIy7C9OGQHTRbxsDwqu" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "access_denied", "state" => "zPUMFIjHjXwB6UIy7C9OGQHTRbxsDwqu"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
----------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_neither_code_nor_error
----------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=hEOe3oyZ%2FVBQ4MlD30P35NhpOYLjEjVn
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?state=hEOe3oyZ%2FVBQ4MlD30P35NhpOYLjEjVn" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"state" => "hEOe3oyZ/VBQ4MlD30P35NhpOYLjEjVn"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
---------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_invalid_client
---------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=nkk42iyMj71CW5v%2F7w1vyuCPTC%2BJeW1%2F
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=nkk42iyMj71CW5v%2F7w1vyuCPTC%2BJeW1%2F" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "nkk42iyMj71CW5v/7w1vyuCPTC+JeW1/"}
Redirected to http://www.example.com/login
Completed 302 Found in 4ms (GC: 0.0ms)
------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_invalid_scope
------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=dFpG4DYWu6gT%2FWiBlIRjKNRoWEJ7%2Fnlm
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=invalid_scope&state=dFpG4DYWu6gT%2FWiBlIRjKNRoWEJ7%2Fnlm" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "invalid_scope", "state" => "dFpG4DYWu6gT/WiBlIRjKNRoWEJ7/nlm"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_server_error
-----------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=KlCvxMDSlOZSBKt%2F5Et1Rb6L58qH9jlK
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=server_error&state=KlCvxMDSlOZSBKt%2F5Et1Rb6L58qH9jlK" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "server_error", "state" => "KlCvxMDSlOZSBKt/5Et1Rb6L58qH9jlK"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
---------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects_given_a_malformed_URI
---------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com\\n\\r@\\n\\revil.example.org/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=sEnklxm9K8xiGGnvsD0WwkPvBmRo3WTH
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=sEnklxm9K8xiGGnvsD0WwkPvBmRo3WTH" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "sEnklxm9K8xiGGnvsD0WwkPvBmRo3WTH"}
Redirect target "http://www.example.com\\n\\r@\\n\\revil.example.org/login" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=sEnklxm9K8xiGGnvsD0WwkPvBmRo3WTH"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects_given_a_double-slash_net_path
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "//evil.example.org"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=cVbTroCZ%2Flqrx6AK4w2of57D0%2FmOi%2FQ2
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=cVbTroCZ%2Flqrx6AK4w2of57D0%2FmOi%2FQ2" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "cVbTroCZ/lqrx6AK4w2of57D0/mOi/Q2"}
Redirect target "//evil.example.org" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=cVbTroCZ%2Flqrx6AK4w2of57D0%2FmOi%2FQ2"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
--------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_CSRF_with_missing_state
--------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=R8luzswWrSsEfgCumMBOFAjilSwWKOP2
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]" for 127.0.0.1 at 2025-11-05 18:04:07 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
----------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_triple-slash_path_target
----------------------------------------------------------------------------
--------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_allows_URL_target_with_same_origin_as_source
--------------------------------------------------------------------------------------
---------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_allows_absolute_path_target
---------------------------------------------------------------------
----------------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_with_different_host_than_source
----------------------------------------------------------------------------------------------
------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_relative_path_target
------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_with_different_protocol_than_source
--------------------------------------------------------------------------------------------------
--------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_empty_URL_target
--------------------------------------------------------------------
----------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_that_is_blank
----------------------------------------------------------------------------
--------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_that_is_not_a_valid_URL
--------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_URL_target_with_different_port_than_source
----------------------------------------------------------------------------------------------
-----------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_invalid_paths
-----------------------------------------------------------------
----------------------------------------------------------------------------
GithubSignIn::RedirectProtectorTest: test_disallows_double-slash_path_target
----------------------------------------------------------------------------
--------------------------------------------------------------------------------
GithubSignIn::ButtonHelperTest: test_generating_a_login_button_with_HTML_content
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
GithubSignIn::ButtonHelperTest: test_generating_a_login_button_with_text_content
--------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
GithubSignIn::ButtonHelperTest: test_generating_a_login_button_with_custom_attributes
-------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------
GithubSignIn::AuthorizationsControllerTest: test_configuring_Github_authorization_URL_including_query_param
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://example.com/auth?client_id=1234567890&param=value&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=DVkpAdEtOfzr%2F4IdzsgtTfqFHhA9pL0u
Completed 302 Found in 2ms (GC: 0.0ms)
----------------------------------------------------------------------------------------
GithubSignIn::AuthorizationsControllerTest: test_redirecting_to_Github_for_authorization
----------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=QlOmjRMb0ogGqGLL5dNy4E9%2BpS%2Ba1u2P
Completed 302 Found in 0ms (GC: 0.0ms)
------------------------------------------------------------
GithubSignIn::IdentityTest: test_extracting_user_information
------------------------------------------------------------
-------------------------------------------------------
GithubSignIn::IdentityTest: test_handling_missing_email
-------------------------------------------------------
----------------------------------------------------
GithubSignIn::IdentityTest: test_handling_API_errors
----------------------------------------------------
--------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_CSRF_with_invalid_state
--------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=HXEehe7SdVIq2ozPDCfxq5weEmmzMOWV
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=invalid" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "invalid"}
Redirected to http://www.example.com/login
Completed 302 Found in 1ms (GC: 0.0ms)
----------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_neither_code_nor_error
----------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=jWcR%2Fb9Ic6x3hLv3i5YVnnEnl2sqaoJ0
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?state=jWcR%2Fb9Ic6x3hLv3i5YVnnEnl2sqaoJ0" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"state" => "jWcR/b9Ic6x3hLv3i5YVnnEnl2sqaoJ0"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
------------------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_unsupported_response_type
------------------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=Vgmmqu%2B7VI3zxUWsQYa7fIWaZqcx2oeC
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=unsupported_response_type&state=Vgmmqu%2B7VI3zxUWsQYa7fIWaZqcx2oeC" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "unsupported_response_type", "state" => "Vgmmqu+7VI3zxUWsQYa7fIWaZqcx2oeC"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_no_proceed_to_URL
-----------------------------------------------------------------------
Started GET "/github_sign_in/callback?code=[FILTERED]&state=invalid" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "invalid"}
Redirect target nil does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=invalid"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
---------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code
---------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=qzdhILr8jH6hCBPjOmpjNNIP4ybkgB1R
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=qzdhILr8jH6hCBPjOmpjNNIP4ybkgB1R" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "qzdhILr8jH6hCBPjOmpjNNIP4ybkgB1R"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_server_error
-----------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=cyUJzpV%2Fy8C2hPbn8kDRxloom40YPksM
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=server_error&state=cyUJzpV%2Fy8C2hPbn8kDRxloom40YPksM" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "server_error", "state" => "cyUJzpV/y8C2hPbn8kDRxloom40YPksM"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
---------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_invalid_client
---------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=ukmU86k%2Ba3S4xFNbVOgK4cskwzHnihkI
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=ukmU86k%2Ba3S4xFNbVOgK4cskwzHnihkI" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "ukmU86k+a3S4xFNbVOgK4cskwzHnihkI"}
Redirected to http://www.example.com/login
Completed 302 Found in 4ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_unsupported_grant_type
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=KzA4hHee7znug7isSvYVApn%2Bs%2F2zYP45
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=KzA4hHee7znug7isSvYVApn%2Bs%2F2zYP45" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "KzA4hHee7znug7isSvYVApn+s/2zYP45"}
Redirected to http://www.example.com/login
Completed 302 Found in 4ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_accepts_proceed_to_paths_if_they_are_absolute
-----------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=dzbt%2Fucak6r%2BFwUJO6HBnTUN7ZqErlq9
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=dzbt%2Fucak6r%2BFwUJO6HBnTUN7ZqErlq9" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "dzbt/ucak6r+FwUJO6HBnTUN7ZqErlq9"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_rejects_proceed_to_paths_if_they_are_relative
-----------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=GeV%2BLzVzpR8EcvcNujcJ8sPNeioJ6tyE
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=GeV%2BLzVzpR8EcvcNujcJ8sPNeioJ6tyE" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "GeV+LzVzpR8EcvcNujcJ8sPNeioJ6tyE"}
Redirect target "login" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=GeV%2BLzVzpR8EcvcNujcJ8sPNeioJ6tyE"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
---------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects_given_a_malformed_URI
---------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com\\n\\r@\\n\\revil.example.org/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=MvNR5tcwP1IFoVJHzpbw4g67e7HouNBc
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=MvNR5tcwP1IFoVJHzpbw4g67e7HouNBc" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "MvNR5tcwP1IFoVJHzpbw4g67e7HouNBc"}
Redirect target "http://www.example.com\\n\\r@\\n\\revil.example.org/login" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=MvNR5tcwP1IFoVJHzpbw4g67e7HouNBc"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
--------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_invalid_request
--------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=iNq37eSkgenoF7AZIC2vBg9a99oBphA9
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=invalid_request&state=iNq37eSkgenoF7AZIC2vBg9a99oBphA9" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "invalid_request", "state" => "iNq37eSkgenoF7AZIC2vBg9a99oBphA9"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_access_denied
------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=8YGwgoMZS3l%2B0WHMgqKUdfe%2BMGy753za
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=access_denied&state=8YGwgoMZS3l%2B0WHMgqKUdfe%2BMGy753za" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "access_denied", "state" => "8YGwgoMZS3l+0WHMgqKUdfe+MGy753za"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects
-----------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://malicious.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=HVzX6aLFqaKcyCS6oAIlDJty7KpL9Ehh
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=HVzX6aLFqaKcyCS6oAIlDJty7KpL9Ehh" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "HVzX6aLFqaKcyCS6oAIlDJty7KpL9Ehh"}
Redirect target "http://malicious.example.com/login" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=HVzX6aLFqaKcyCS6oAIlDJty7KpL9Ehh"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects_given_a_double-slash_net_path
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "//evil.example.org"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=Y4eNt500lwq4poH0qmpeJbFXA%2BFprfMg
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=Y4eNt500lwq4poH0qmpeJbFXA%2BFprfMg" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "Y4eNt500lwq4poH0qmpeJbFXA+FprfMg"}
Redirect target "//evil.example.org" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=Y4eNt500lwq4poH0qmpeJbFXA%2BFprfMg"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_invalid_scope
------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=9a9Vhthiv2es%2Blh5DfgUhofc%2BHr6vPWG
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=invalid_scope&state=9a9Vhthiv2es%2Blh5DfgUhofc%2BHr6vPWG" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "invalid_scope", "state" => "9a9Vhthiv2es+lh5DfgUhofc+Hr6vPWG"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
---------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_CSRF_without_flash_state
---------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=kj5jDhcixHYatsl03tBltO8NqvgVu8Ub
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=invalid" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "invalid"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
----------------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_temporarily_unavailable
----------------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=iYLNTJ6h0C7ssCSv50JA58xTrRNbsDli
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=temporarily_unavailable&state=iYLNTJ6h0C7ssCSv50JA58xTrRNbsDli" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "temporarily_unavailable", "state" => "iYLNTJ6h0C7ssCSv50JA58xTrRNbsDli"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
--------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_unauthorized_client
--------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=82ZhYRvlTZXY5KnxduLj2%2B5KTuw775xk
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=82ZhYRvlTZXY5KnxduLj2%2B5KTuw775xk" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "82ZhYRvlTZXY5KnxduLj2+5KTuw775xk"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (GC: 0.0ms)
--------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_CSRF_with_missing_state
--------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=7406AniXoJb4TBxdEUHc3LOFZekCYF5H
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
------------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_authorization_code_grant_error:_unauthorized_client
------------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=EXfeYqmg9BzlNULI5UHsgS7h1mA8as5l
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=unauthorized_client&state=EXfeYqmg9BzlNULI5UHsgS7h1mA8as5l" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "unauthorized_client", "state" => "EXfeYqmg9BzlNULI5UHsgS7h1mA8as5l"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
----------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_invalid_request
----------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=RIIYhxp1JOZmOGsUtVMfyesTiemfpebO
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=RIIYhxp1JOZmOGsUtVMfyesTiemfpebO" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "RIIYhxp1JOZmOGsUtVMfyesTiemfpebO"}
Redirected to http://www.example.com/login
Completed 302 Found in 4ms (GC: 0.0ms)
--------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_access_token_request_error:_invalid_grant
--------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=Octtgq9%2BjYTxOof9cHFus3QG3LQXNhLF
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=Octtgq9%2BjYTxOof9cHFus3QG3LQXNhLF" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "Octtgq9+jYTxOof9cHFus3QG3LQXNhLF"}
Redirected to http://www.example.com/login
Completed 302 Found in 5ms (GC: 0.0ms)
------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_receiving_an_invalid_authorization_error
------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "http://www.example.com/login"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=j8DlWx4WgGIIU2Ql9Yp6pa4i7VSAGZFp
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?error=unknown+error+code&state=j8DlWx4WgGIIU2Ql9Yp6pa4i7VSAGZFp" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"error" => "unknown error code", "state" => "j8DlWx4WgGIIU2Ql9Yp6pa4i7VSAGZFp"}
Redirected to http://www.example.com/login
Completed 302 Found in 0ms (GC: 0.0ms)
-----------------------------------------------------------------------------------------------------------
GithubSignIn::CallbacksControllerTest: test_protecting_against_open_redirects_given_a_triple-slash_net_path
-----------------------------------------------------------------------------------------------------------
Started POST "/github_sign_in/authorization" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::AuthorizationsController#create as HTML
  Parameters: {"proceed_to" => "///evil.example.org"}
Redirected to https://github.com/login/oauth/authorize?client_id=1234567890&redirect_uri=http%3A%2F%2Fwww.example.com%2Fgithub_sign_in%2Fcallback&response_type=code&scope=user%3Aemail%20read%3Auser&state=5cy08Ghtd9EXREXjAKt0Uz15RZY%2BBXvV
Completed 302 Found in 0ms (GC: 0.0ms)
Started GET "/github_sign_in/callback?code=[FILTERED]&state=5cy08Ghtd9EXREXjAKt0Uz15RZY%2BBXvV" for 127.0.0.1 at 2025-11-05 18:04:09 -0600
Processing by GithubSignIn::CallbacksController#show as HTML
  Parameters: {"code" => "[FILTERED]", "state" => "5cy08Ghtd9EXREXjAKt0Uz15RZY+BXvV"}
Redirect target "///evil.example.org" does not have same origin as request "http://www.example.com/github_sign_in/callback?code=the-code&state=5cy08Ghtd9EXREXjAKt0Uz15RZY%2BBXvV"
Completed 400 Bad Request in 0ms (GC: 0.0ms)
